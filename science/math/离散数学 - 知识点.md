# 离散数学 - 知识点

离散数学作为 CS 的基础课，却并不是其它专业的基础课。在进行计算机相关课程的学习时，如果没有离散数学的基础，会碰到一些理论上的困难。  

参考：  
《离散数学（第 2 版）》屈婉玲，耿素云，张立昂，高等教育出版社。

[toc]

## 1 命题逻辑的基本概念

### 1.1 命题与联结词

- 非真即假的陈述句称作**命题**

> 陈述句是陈述一个事实或者说话人看法的句型。陈述句分为肯定的陈述句和否定的陈述句，简称肯定句和否定句。（摘自百度百科-陈述句）

- 作为命题的陈述句所表达的判断结果称作命题的**真值**，真值只能取两个值：**真**或**假**。真值为真的命题称为**真命题**，真值为假的命题称为**假命题**。
- 不能被分解为更简单的命题称作**简单命题**或**原子命题**。由简单命题通过联结词联结而成的命题，称作**复合命题**。

> 命题的非真即假是指命题要么为真，要么为假，而不是可能为真，可能为假。  
> 对于陈述：2 是偶数。该陈述一定为真，因此是命题。  
> 对于陈述：X 是偶数，其中 X 是正整数。该陈述不一定为真，因此不是命题。  
> 对于陈述：我正在说假话。如果命题为真，则根据命题可以推断出命题为假；反之亦然。  

- 如果一个命题能由真推出假，由假推出真，也即这个命题既不能为真，也不能为假，则称为**悖论**。**悖论不是命题**。

- **定义 1.1**  
  设 $p$ 为命题，复合命题“非 $p$”（或 “$p$ 的否定”）称作 $p$ 的**否定式**，记作 $\lnot p$ 。$\lnot$ 称作**否定联结词**。规定 $\lnot p$ 为真当且仅当 $p$ 为假。
- **定义 1.2**  
  设 $p$, $q$ 为两个命题，复合命题“$p$ 并且 $q$”（或 “$p$ 与 $q$ ”）称为 $p$ 与 $q$ 的**合取式**，记作 $p\land q$ 。$\land$ 称作**合取联结词**。规定 $p\land q$ 为真当且仅当 $p$ 与 $q$ 同时为真。
- **定义 1.3**  
  设 $p$, $q$ 为两个命题，复合命题“$p$ 或 $q$”称作 $q$ 与 $q$ 的**析取式**，记作 $p\lor q$。$\lor$ 称作**析取联结词**。规定 $p\lor q$ 当且仅当 $p$ 与 $q$ 同时为假。
- **定义 1.4**  
  设 $p$, $q$ 为两个命题，复合命题“如果 $p$ ，则 $q$” 称为 $p$ 与 $q$ 的**蕴涵式**，记作 $p\to q$ ，并称 $p$ 是蕴含式的**前件**，$q$ 为蕴涵式的**后件**。$\to$ 称作**蕴涵联结词**。并规定 $p\to q$ 为假当且仅当 $p$ 为真 $q$ 为假。

> 蕴含式是一个命题，因此是一个非真即假的陈述句。蕴含式仅说明陈述句具有蕴涵结构。  
> 注意蕴涵关系里，$p$ 和 $q$ 不需要有逻辑上的联系。  
> 若 $p$ 为真，$q$ 为真，则 $p\to q$ 为真。例如：如果太阳从东边升起，则 1 等于 1。  
> 若 $p$ 为真，$q$ 为假，则 $p\to q$ 为假，例如：如果太阳从东边升起，则 1 等于 2。  
> 若 $p$ 为假，则 $p\to q$ 为真。这是因为假设的命题不为真，则推导的命题也就无法验证。例如：如果太阳从西边升起，则 1 等于 2。因为假设不成立，因此也就无法验证假设的推导是否成立。

> $p\to q$ 语义上是 $p$ 蕴涵 $q$ ，也即 $q$ 是 $p$ 的必要条件。  
> 蕴涵关系（$p\to q$）的几种表述形式：  
>
> - 若 $p$ ，则 $q$ 。  
> - 只要 $p$ ，则 $q$ 。  
> - $p$ ，仅当 $q$ 。
> - 除非 $q$ ，才有 $p$ 。
> - 除非 $q$ ，否则 $p$ 不发生。
> - 只有 $q$ ，才有 $p$ 。

- **定义 1.5**
  设 $p$, $q$ 为两个命题，复合命题“ $p$ 当且仅当 $q$” 称作 $p$ 与 $q$ 的等价式，记作 $p \leftrightarrow q$ ，$\leftrightarrow$ 称作**等价联结词**。规定 $p\leftrightarrow q$ 为真当且仅当 $p$ 与 $q$ 同时为真或同时为假。

> **命题符号化**的例子  
> - 吴颖既用功又聪明  
> $p$：吴颖用功  
> $q$：吴颖聪明  
> $p\land q$  
> - 张辉虽然聪明，但不用功  
> $p$：张辉聪明  
> $q$：张辉用功  
> $p\land \lnot q$  
> - 张晓静是江西人或安徽人  
> $p$：张晓静是江西人  
> $q$：张晓静是安徽人  
> $p\lor q$  
> - 张静初只能挑选 202 房间或 203 房间  
> $p$：张静初挑选 202 房间  
> $q$：张静初挑选 203 房间  
> 注意互斥性，因此为 $(p\lor \lnot q)\lor (\lnot p\land q)$  
> - 如果 $3+3=6$ ，则雪是白色的  
> $p$：$3+3=6$  
> $q$：$雪是白色的$
> $p\to q$，$p$ 的真值为真，$q$ 的真值为真，$p\to q$ 的真值为真。
> - 只要 $a$ 能被 $4$ 整除，则 $a$ 一定能被 $2$ 整除  
> - $a$ 能被 $4$ 整除，仅当 $a$ 能被 $2$ 整除  
> - 只有 $a$ 能被 $2$ 整除，$a$ 才能被 $4$ 整除  
> $p$：$a$ 能被 $4$ 整除  
> $q$：$a$ 能被 $2$ 整除  
> $p\to q$  
> $p$ 和 $q$ 都不具有确定的值，但是 $p\to q$ 本身为真。
> - $\sqrt{3}$ 是无理数当且仅当加拿大位于亚洲  
> $p$：$\sqrt{3}$ 是无理数  
> $q$：加拿大位于亚洲  
> $p\leftrightarrow q$  
> $p$ 的真值为 1，$q$ 的真值为 0，$p\leftrightarrow q$ 的真值为 0。

### 1.2 命题公式及其赋值（命题形式及真值表）

本节解决问题：  

1. 是不是所有符号串都是命题？  
2. 符号串的真假值如何判断？  

- 简单命题是命题逻辑中最基本的研究单位，其真值是确定的，又称为**命题常项**，或**命题常元**。取值 1 （真）或 0 （假）的变元称作**命题变项**，或**命题变元**。
- 将命题变项用联结词和圆括号按照一定的逻辑关系联结起来的符号串称作**合式公式**。

- **定义 1.6**  
  （1）单个命题变项是合式公式，并称为原子命题公式。  
  （2）若 $A$ 是合式公式，则 $(\lnot A)$ 是合式公式。  
  （3）若 $A$, $B$ 是合式公式，则 $(A\land B)$, $(A \lor B)$, $(A\to B)$, $ (A\leftrightarrow B)$ 是合式公式。  
  （4）有限次地应用（1）～（3）形成的符号串是合式公式。  
  注意：严格来讲，命题公式都是有括号的，只是可以把不影响运算次序的括号省略。  
  这是一种归纳定义的定义方法。  

- **命题形式的 BNF**（Bacus Normal Form）：  
  $\alpha ::= p | (\lnot \alpha) | (\alpha\lor \beta) | (\alpha\land \beta) | (\alpha\rightarrow\beta) | (\alpha\leftrightarrow\beta)$  
  ::= 理解为“定义为”。  

- 合式公式也称作**命题公式**或**命题形式**，简称为**公式**。
- 设 $A$ 为合式公式，$B$ 是 $A$ 的一部分，若 $B$ 也是合式公式，则称 $B$ 为 $A$ 的**子公式**。
- **对象语言**是用来描述研究对象的语言，**元语言**是用来描述对象语言的语言。

- **定义 1.7**  
  （1）若公式 $A$ 是单个的命题变项，则称 $A$ 为 $0$ 层公式。  
  （2）称 $A$ 是 $n+1(n \ge 0)$ 层公式是指下面的情况之一。  
  （a）$A=\lnot B$，$B$ 是 $n$ 层公式；  
  （b）$A=B\land C$，其中 $B$, $C$ 分别为 $i$ 和 $j$ 层公式，且 $n=max(i,j)$；  
  （c）$A=B\lor C$, $A=B\to C$, $A=B\leftrightarrow C$，其中 $B$, $C$ 的层次分别同（b）。  
  （3）若公式 $A$ 的层次为  $k$，则称 $A$ 是 $k$ 层公式。

> 公式的层数：  
> 单目联结词使公式层数增 1。  
> 双目联结词使公式层数在两个参与与运算的公式的最高层数基础上增 1。  

- 命题形式的值由命题形式中的命题变元的值完全确定。  

- **定义 1.8**  
  设 $p_1, p_2, ..., p_n$ 是出现在公式 $A$ 中的全部命题变项，给 $p_1, p_2, ..., p_n$ 各指定一个真值，称为对 $A$ 的一个**赋值**或**解释**或**指派**。若指定的一组值使 $A$ 为 1，则称这组值为 $A$ 的**成真赋值**（成真指派）；若使 $A$ 为 0，则称这组值为 $A$ 的**成假赋值**（成假指派）。

> 含 $n(n \ge 1)$ 个命题变项的公式共有 $2^n$ 个不同的赋值。

- **定义 1.9**  
  将命题公式 $A$ 在所有赋值下取值情况列成表，称作 $A$ 的**真值表**。

> 构造真值表的具体步骤：  
> （1）找出公式中所含的全体命题变项 $p_1, p_2, ..., p_n$ ，列出 $2^n$ 个赋值。赋值从 $00...0$ 开始，然后按二进制加法加 1 ，依次写出每个赋值，直到 $11...1$ 为止。  
> （2）按照从低到高的顺序写出公式的各个层次。  
> （3）对应各个赋值计算出各层次的真值，直到最后计算出公式的真值。

> 例：求 $\lnot p$ 的真值表。
> $p$ | $\lnot p$
> :-: | :-:
> 0 | 1
> 1 | 0

> 例：求 $p\to q$ 的真值表。
> $p$ | $q$ | $p \to q$
> :-: | :-: | :-:
> 0 | 0 | 1
> 0 | 1 | 1
> 1 | 0 | 0
> 1 | 1 | 1

> 例：求 $p \leftrightarrow q$ 的真值表。
> $p$ | $q$ | $p\leftrightarrow q$
> :-: | :-: | :-:
> 0 | 0 | 1
> 0 | 1 | 0
> 1 | 0 | 0
> 1 | 1 | 1

- 如果两个公式 $A$ ，$B$ 的真值表对所有赋值最后一列都相同，即最后结果都相同，则称这**两个真值表相同**。

- **定义 1.10**  
  设 $A$ 为任一命题公式。  
  （1）若 $A$ 在它的各种赋值下取值均为真，则称 $A$ 为**重言式**或**永真式**。  
  （2）若 $A$ 在它的各种赋值下取值均为假，则称 $A$ 为**矛盾式**或**永假式**。  
  （3）若 $A$ 不是矛盾式，则称 $A$ 为**可满足式**。

> 若真值表的全为 1，则为永真式，若全为 0，则为永假式，若有 1，则为可满足式。

> 扩展：布尔逻辑的可满足问题（SAT 问题）是历史上第一个被证明的 NPC 问题，居七个“千禧年”数学难题之首。  

- 设公式 $A, B$ 共含有命题变项 $p_1,p_2,...,p_n$ ，而 $A$ 或 $B$ 不全含这些命题变项，例如，$A$ 中不含 $p_{i},p_{i+1},...,p_n,i\ge 2$ ，称这些命题变项为 $A$ 的**哑元**。

## 2 命题逻辑等值演算

### 2.1 等值式

- **定义 2.1**  
  设 $A,B$ 是两个命题公式，若 $A,B$ 构成的等价式 $A\leftrightarrow B$ 为重言式，则称 $A$ 与 $B$ 是**等值**的，记作 $A\Leftrightarrow B$ 。

> 注：  
> $\Leftrightarrow$ 是元语言符号，而 $\leftrightarrow$ 是对象语言符号。  
> 对命题常项（陈述句）而言，等价是陈述句的陈述形式。对命题变项而言，等价是命题变项或其组合（合式公式）之间的联系。等值是针对两个命题公式（也即合式公式）而言，表示两个公式在任何情况下（所含的命题变项的所有取值组合）都具有相同的值。  
> 若 $A$ 和 $B$ 等值，则 $A, B$ 等价为真。

- 设 $A$ 是一个命题公式，含有命题变项 $p_1,p_2,...,p_n$ ，又设 $A_1,A_2,...,A_n$ 是任意的命题公式。对每一个 $i(i=1,2,...,n)$ ，把 $p_i$ 在 $A$ 中的所有出现都替换成 $A_i$ ，所得到的新命题公式记作 $B$ 。那么，如果 $A$ 是重言式，则 $B$ 也是重言式。将重言式中的任意命题变项替换成任意公式后得到的公式也是重言式，称前后两个公式为**等值式模式**。

> **常用的 16 组等值式模式**
>
> 1. 双重否定律  
> $A\Leftrightarrow \lnot\lnot A$  
> 证明：
>
> $p$ | $\lnot p$ | $\lnot \lnot p$
> :-: | :-: | :-:
> 0 | 1 | 0
> 1 | 0 | 1
>
> 2. 幂等律  
> $A\Leftrightarrow A\land A$  
> $A\Leftrightarrow A\lor A$  
> 证明：  
>
> $p$ | $p\land p$ | $p\lor p$
> :-: | :-: | :-:
> 0 | 0 | 0
> 1 | 1 | 1
>
> 3. 交换律  
> $A\lor B\Leftrightarrow B\lor A$  
> $A\land B\Leftrightarrow B\land A$  
> 证明：显然。
>
> 4. 结合律  
> $(A\land B)\land C\Leftrightarrow A\land (B\land C)$  
> $(A\lor B)\lor C\Leftrightarrow A\lor(B \lor C)$  
> 证明：略。  
>
> 5. 分配律  
> $A\lor(B \land C)\Leftrightarrow (A\lor B)\land (A\lor C)$  
> $A\land(B\lor C)\Leftrightarrow (A\land B)\lor (A\land C)$  
> 证明：略。
>
> > 补充：  
> > $(A\land B)\lor (C\land D)\Leftrightarrow$  
> > $(A\lor C)\land (A\lor D)\land (B\lor C)\land (B\lor D)$  
> > $(A\lor B)\land (C\lor D)\Leftrightarrow$  
> > $(A\land C)\lor (A\land D)\lor (B\land C)\lor (B\land D)$
>
> 6. 德摩根律  
> $\lnot (A\lor B)\Leftrightarrow \lnot A\land \lnot B$  
> $\lnot (A\land B)\Leftrightarrow \lnot A\lor \lnot B$  
> 证明：  
> 只证一个。
>
> $p$ | $q$ | $p\lor q$ | $\lnot(p\lor q)$ | $\lnot p$ | $\lnot q$ | $\lnot p \land \lnot q$
> :-: | :-: | :-: | :-: | :-: | :-: | :-:
> 0 | 0 | 0 | 1 | 1 | 1 | 1
> 0 | 1 | 1 | 0 | 1 | 0 | 0
> 1 | 0 | 1 | 0 | 0 | 1 | 0
> 1 | 1 | 1 | 0 | 0 | 0 | 0
>
> 7. 吸收律  
> $A\lor (A\land B)\Leftrightarrow A$  
> $A\land(A\lor B)\Leftrightarrow A$
>
> $p$ | $q$ | $p\land q$ | $p\lor(p\land q)$
> :-: | :-: | :-:        | :-:
> 0 | 0 | 0 | 0
> 0 | 1 | 0 | 0
> 1 | 0 | 0 | 1
> 1 | 1 | 1 | 1
>
> 8. 零律  
> $A\lor 1\Leftrightarrow 1$  
> $A\land 0 \Leftrightarrow 0$
>
> 9. 同一律  
> $A\lor 0\Leftrightarrow A$  
> $A\land 1\Leftrightarrow A$
>
> 10. 排中律  
> $A\lor \lnot A\Leftrightarrow 1$
>
> 11. 矛盾律  
> $A\land \lnot A\Leftrightarrow 0$  
>
> 12. 蕴涵等值式  
> $A\to B\Leftrightarrow \lnot A\lor B$  
> 证明：  
>
> $p$ | $q$ | $\lnot p$ | $p\to q$ | $\lnot p\lor q$
> :-: | :-: | :-:       | :-:      | :-:
> 0 | 0 | 1 | 1 | 1
> 0 | 1 | 1 | 1 | 1
> 1 | 0 | 0 | 0 | 0
> 1 | 1 | 0 | 1 | 1
>
> 13. 等价等值式  
> $A\leftrightarrow B\Leftrightarrow(A\to B)\land(B\to A)$  
>
> $p$ | $q$ | $p\to q$ | $q\to p$ | $(p\to q)\land (q\to p)$ | $p\leftrightarrow q$
> :-: | :-: | :-:      | :-:      | :-:                      | :-:
> 0 | 0 | 1 | 1 | 1 | 1
> 0 | 1 | 1 | 0 | 0 | 0
> 1 | 0 | 0 | 1 | 0 | 0
> 1 | 1 | 1 | 1 | 1 | 1
>
> 14. 假言易位  
> $A\to B\to \lnot B \to \lnot A$  
>
> $p$ | $q$ | $p\to q$ | $\lnot p$ | $\lnot q$ | $\lnot q\to \lnot p$
> :-: | :-: | :-:      | :-:       | :-:       | :-:
> 0 | 0 | 1 | 1 | 1 | 1
> 0 | 1 | 1 | 1 | 0 | 1
> 1 | 0 | 0 | 0 | 1 | 0
> 1 | 1 | 1 | 0 | 0 | 1
>
> 15. 等价否定等值式
> $A\leftrightarrow B\Leftrightarrow \lnot A\leftrightarrow \lnot B$  
>
> $p$ | $q$ | $\lnot p$ | $\lnot q$ | $p\leftrightarrow q$ | $\lnot p\leftrightarrow \lnot q$
> :-: | :-: | :-:       | :-:       | :-:                  | :-:
> 0 | 0 | 1 | 1 | 1 | 1
> 0 | 1 | 1 | 0 | 0 | 0
> 1 | 0 | 0 | 1 | 0 | 0
> 1 | 1 | 0 | 0 | 1 | 1
>
> 16. 归谬论  
> $(A\to B)\land(A\to\lnot B)\Leftrightarrow \lnot A$
>
> $p$ | $q$ | $\lnot p$ | $\lnot q$ | $p\to q$ | $p\to \lnot q$ | $(p\to q)\land (p\to \lnot q)$
> :-: | :-: | :-:       | :-:       | :-:      | :-: | :-:
> 0 | 0 | 1 | 1 | 1 | 1 | 1
> 0 | 1 | 1 | 0 | 1 | 1 | 1
> 1 | 0 | 0 | 1 | 0 | 1 | 0
> 1 | 1 | 0 | 0 | 1 | 0 | 0

> **可以观察，等值关系和集合关系具有一致性**。  
> 否定联结词对应集合关系的补集。  
> 合取联结词对应集合关系的交集。  
> 析取联结词对应集合关系的合集。  

- 将公式代入等值式模式即可得到一个具体的等值式，称为等值式模式的**代入实例**。
- 由已知的等值式推演出另外一些等值式的过程称作**等值演算**。
- **置换规则**设 $\Phi(A)$ 是含公式 $A$ 的命题公式，$\Phi(B)$ 是用公式 $B$ 置换 $\Phi(A)$ 中 $A$ 的所有出现后得到的命题公式。若 $B\Leftrightarrow A$ ，则 $\Phi(A)\Leftrightarrow \Phi(B)$ 。

### 2.2 析取范式与合取范式

- **定义 2.2**  
  命题变项及其否定统称作**文字**。仅由有限个文字构成的析取式称作**简单析取式**。仅由有限个文字构成的合取式称作**简单合取式**。

> 文字如：$p,\lnot q$  
> 简单析取式如：$p\lor q,$  
> 简单合取式如：$p\land q$  

- **定理 2.1**  
  （1）一个简单析取式是重言式当且仅当它同时含某个命题变项及它的否定式。  
  （2）一个简单合取式是矛盾式当且仅当它同时含某个命题变项及它的否定式。

- **定义 2.3**  
  由有限个简单合取式的析取构成的命题公式称作**析取范式**。由有限个简单析取式的合取构成的命题公式称作**合取范式**。析取范式与合取范式统称作**范式**。

> 范式分为析取范式和合取范式。以析取范式为例，析取范式由简单析取式构成，简单析取式由文字的析取式构成，文字只能是命题变项或者其否定。  
> 析取范式如 $p\lor (\lnot p\land q)\lor (p\land q)$  
> 合取范式如 $p\land (p\lor q)\land (p\lor \lnot q)$  

- **定理 2.2**  
  （1）一个析取范式是矛盾式当且仅当它的每个简单合取式都是矛盾式。  
  （2）一个合取范式是重言式当且仅当它的每个简单析取式都是重言式。

- **定理 2.3**  
  **范式存在定理**  
  任一命题都存在与之等值的析取范式与合取范式。

> **求给定公式范式的步骤**为：  
>
> 1. 消去联结词 $\to$, $\leftrightarrow$ 。  
> $A\to B\Leftrightarrow \lnot A\lor B$  
> $A\leftrightarrow B\Leftrightarrow (A\to B)\land (B\to A)$  
>
> 2. 用双重否定律消去双重否定符，用德摩根律内移否定符。  
> $\lnot\lnot A\Leftrightarrow A$  
> $\lnot(A\lor B)\Leftrightarrow \lnot A\land \lnot B$  
> $\lnot(A\land B)\Leftrightarrow \lnot A\lor \lnot B$
>
> 3. 使用分配律。  
> $A\lor (B\land C)\Leftrightarrow (A\lor B)\land (A\lor C)$  
> $A\land (B\lor C)\Leftrightarrow (A\land B)\lor (A\land C)$

> **例**：求 $(p\to q)\leftrightarrow r$ 的析取范式和合取范式。  
> 合取范式：  
> $(p\to q)\leftrightarrow r$ $\Leftrightarrow$  
> $(\lnot p\lor q)\leftrightarrow r$ $\Leftrightarrow$  
> $((\lnot p\lor q) \to r)\land(r\to (\lnot p\lor q))$  $\Leftrightarrow$  
> $(\lnot r \lor (\lnot p\lor q))\land (\lnot (\lnot p\lor q)\lor r)$ $\Leftrightarrow$  
> $(\lnot r \lor \lnot p \lor q)\land ((p\land \lnot q)\lor r)$ $\Leftrightarrow$  
> $(\lnot r \lor \lnot p\lor q)\land (p\lor r)\land (\lnot q\lor r)$  
> 析取范式：  
> 应用分配律时调整分配方式，即可。  
> $(\lnot r \lor \lnot p \lor q)\land ((p\land \lnot q)\lor r)$ $\Leftrightarrow$  
> $(\lnot r\land p\land \lnot q)\lor (\lnot r\land r)\lor (\lnot p\land p\land \lnot q)\lor (\lnot p\land r)\lor (q\land p\land \lnot q)\lor (q\land r)\Leftrightarrow$  
> $(\lnot r\land p\land \lnot q)\lor (\lnot p\land r)\lor (q\land r)$

- **定理 2.4**  
  在含有 $n$ 个命题变项的简单合取式（简单析取式）中，若每个命题变项和它的否定式恰好出现一个且仅出现一次，而且命题变项或它的否定式按照下标从小到大或按照字典顺序排列，称这样的简单合取式（简单析取式）为**极小项（极大项）**。

> **两个命题变项的极小项与极大项**
>
> 极小项 | 成真赋值 | 名称
> :-:   | :-:    | :-:
> $\lnot p\land \lnot q$ | `0 0` | $m_0$
> $\lnot p\land q$ | `0 1` | $m_1$
> $p\land \lnot q$ | `1 0` | $m_2$
> $p\land q$ | `1 1` | $m_3$
>
> 极大项 | 成假赋值 | 名称
> :-:   | :-:    | :-:
> $p\lor q$ | `0 0` | $M_0$
> $p\lor \lnot q$ | `0 1` | $M_1$
> $\lnot p\lor q$ | `1 0` | $M_2$
> $\lnot p\lor \lnot q$ | `1 1` | $M_3$

- **定理 2.4**  
  设 $m_i$ 与 $M_i$ 是命题变项含 $p_1,p_2,...,p_n$ 的极小项和极大项，则 $\lnot m_i\Leftrightarrow M_i$, $\lnot M_i\Leftrightarrow m_i$ 。

- **定义 2.5**  
  所有简单合取式（简单析取式）都是极小项（极大项）的析取范式（合取范式）称为**主析取范式（主合取范式）**。

> 主析取范式由简单合取式组成；主合取范式由简单析取式组成。

> **例**：求 $(p\to q) \leftrightarrow r$ 的主析取范式和主合取范式。  
> 已有析取范式为 $(\lnot r\land p\land \lnot q)\lor (\lnot p\land r)\lor (q\land r)$ ， 合取范式为 $(\lnot r \lor \lnot p\lor q)\land (p\lor r)\land (\lnot q\lor r)$ 。  
>
> $p\land \lnot q\land \lnot r$ $\Leftrightarrow$  
> $m_4$  
>
> $(\lnot p \land r)$ $\Leftrightarrow $  
> $\lnot p\land r\land (q\lor \lnot q)$  
> $(\lnot p\land r\land q)\lor (\lnot p\land r\land \lnot q)$  
> $m_3 \lor m_1$  
>
> $q\land r$  
> $(p\lor \lnot p)\land q\land r$  
> $(p\land q\land r)\lor (\lnot p\land q\land r)$  
> $m_7\lor m_3$  
> 故主析取范式为 $m_1\lor m_3\lor m_4 \lor m_7$ 。
>
> $p\lor r$ $\Leftrightarrow$  
> $p\lor (q \land \lnot q)\lor r$ $\Leftrightarrow$  
> $(p\lor q\lor r)\land (p\lor \lnot q\lor r)$ $\Leftrightarrow$  
> $M_0\land M_2$  
>
> $\lnot q\lor r$ $\Leftrightarrow$  
> $(p\land \lnot p)\lor \lnot q\lor r$ $\Leftrightarrow$  
> $(p\lor \lnot q\lor r)\land (\lnot p\lor \lnot q\lor r)$  
> $M_2\lor M_6$
>
> $\lnot r\lor \lnot p\lor q$  
> $M_5$  
>
> 即主合取式为 $M_0\land M_2\land M_5 \land M_6$ 。

> **例**：求命题公式 $p\to q$ 的主析取范式与主合取范式。  
> $p\to q$ $\Leftrightarrow$  
> $\lnot p\lor q$ $\Leftrightarrow$  
> $M_2$  
> $\Leftrightarrow$  
> $(\lnot p\land (q\lor \lnot q))\lor ((p\lor \lnot p)\land q)$ $\Leftrightarrow$  
> $(\lnot p\land q)\lor (\lnot p\lor \lnot q)\lor (p\land q)\lor (\lnot p\land q)$ $\Leftrightarrow$  
> $m_0\lor m_1\lor m_3$

> **扩展**  
> **析取范式和合取范式的变换**  
> $p\lor q$ $\Leftrightarrow$  
> $M_0$ $\Leftrightarrow$  
> $(p\land (q\lor \lnot q))\lor ((p\lor \lnot p)\land q)$ $\Leftrightarrow$  
> $(p\land q)\lor (p\land \lnot q)\lor (p\land q)\lor (\lnot p\land q)$ $\Leftrightarrow$  
> $m_1 \lor m_2 \lor m_3$
>
> $p\land q$ $\Leftrightarrow$  
> $m_3$ $\Leftrightarrow$  
> $(p\lor (q\land \lnot q))\land ((p\land \lnot p)\lor q)$ $\Leftrightarrow$  
> $(p\lor q)\land (p\land \lnot q)\land (p\lor q)\land (\lnot p\lor q)$ $\Leftrightarrow$  
> $M_0 \land M_1 \land M_2$

- **定理 2.5**  
  任何命题公式都存在与之等值的主析取范式和主合取范式，并且是唯一的。

- **主析取范式、主合取范式的应用**  
  - 求公式的成真赋值与成假赋值  
    例如，主析取范式的简单析取式的下标的二进制形式即为成真赋值；主合取范式的简单合取式的下标的二进制形式即为成假赋值。
  - 判断公式的类型  
    如判断公式是否为重言式、矛盾式；是否为可满足式。  
    如果析取式存在 $2^n$ 个简单析取式，则为重言式（永真式），如果不存在（为空，0），则为矛盾式；存在简单析取式，则为可满足式。  
    如果合取式存在 $2^n$ 个简单合取式，则为矛盾式（永假式），如果不存在（为空，0），则为重言式；简单合取式的数量小于 $2^n$ 个，则为可满足式。  
  - 判断两个公式是否等值  
    写出两个公式的主析取范式或者主合取范式，如果一致，则等值；否则不等值。  

> **例**  
> 判断 $p$ 与 $(p\land q)\lor (p\land \lnot q)$ 是否等值。  
> 第二个公式是主析取式，为 $m_2 \lor m_3$

### 2.3 联结词的完备集

- **引导问题**：  
  - 为什么只考虑五个联结词？  
    - 这五个联结词能否表示所有联结词？  
    - 这五个联结词是否有多余的？  
  - 什么是联结词？  
  - 什么是一些联结词表示了一个联结词？  
  - 什么是联结词的“多余”？  

- 联结词确定了复合命题的构造方式，复合命题建立了真假值对应方式。

- **定义 2.6**  
  称 $F:\{0,1\}^n\to \{0,1\}$ 为 **$n$** **元真值函数**。

> 这里是集合论中的写法，$A^n=\{<a_1,a_2,...,a_n>|a_i\in A, 1\le i\le n\}$，因此如果 $A=\{0,1\}$ ，则为 $\{0,1\}^n=\{<a_1,a_2,...,a_n>|a_i\in\{0,1\},1\le i\le n\}$

> $n$ 元真值函数的定义域和值域  
> 定义域：由 $0,1$ 组成的长为 $n$ 的符号串的全体，即 $\{0..00,0..01,...,1...11\}$  
> 值域：$0$ 和 $1$，即 $\{0,1\}$

> 对 $n$ 元真值函数，其自变量共有 $2^n$ 种，$2^n$ 种自变量对应 $2^{(2^n)}$ 种值域取值（每一个自变量组合对应因变量两个取值）。  
> 例如，$1$ 元真值函数总共有 $2^{(2^1)}=4$ 个。  
>
> $p$ | $F_0^{(1)}$ | $F_1^{(1)}$ | $F_2^{(1)}$ | $F_3^{(1)}$
> :-: | :-: | :-: | :-: | :-:
> 0 | 0 | 0 | 1 | 1
> 1 | 0 | 1 | 0 | 1
>
> $p$ | $q$ | $F_0^{(2)}$ | $F_1^{(2)}$ | $F_2^{(2)}$ | $F_3^{(2)}$ | ...
> :-: | :-: | :-: | :-: | :-: | :-: | :-:
> 0 | 0 | 0 | 0 | 0 | 0 | ... 
> 0 | 1 | 0 | 0 | 0 | 0 | ...
> 1 | 0 | 0 | 0 | 1 | 1 | ...
> 1 | 1 | 0 | 1 | 0 | 1 | ...

- 一个联结词确定一个真值函数，一个命题形式也确定一个真值函数。  

- 一个真值函数与一个主析取范式或合取范式唯一等值。

> $F_0^{(2)}$ 表示取值总为 $0$ ，即矛盾式。  
> $F_1^{(2)}$ 表示 $m_3$ （全为真时为真）。  
> $F_3^{(2)}$ 表示 $m_2\lor m_3$ 。

- **定义 2.7**  
  设 $S$ 是一个联结词集合，如果任何 $n(n\ge 1)$ 元真值函数都可以由仅含 $S$ 中的联结词构成的公式表示，则称 $S$ 是**联结词完备集**。

- **定理 2.6**  
  $S=\{\lnot,\land,\lor\}$ 是联结词完备集。

> 证明：因为任意一个真值函数都与唯一的一个主析取范式等值，而主析取范式中只用到了 $\lnot$、$\land$、$\lor$ ，因此 $S=\{\lnot,\land,\lor\}$ 是联结词完备集。  

- **定理 2.6 推论**  
  以下联结词集都是联结词完备集。  
  （1）$S_1=\{\lnot,\land,\lor,\to\}$  
  （2）$S_2=\{\lnot,\land,\lor,\to,\leftrightarrow\}$  
  （3）$S_3=\{\lnot,\land\}$  
  （4）$S_4=\{\lnot,\lor\}$  
  （5）$S_5=\{\lnot,\to\}$  

- **定义 2.8**  
  设 $p,q$ 是两个命题，复合命题“ $p$ 与 $q$ 的否定式”称作 $p,q$ 的**与非式**，记作 $p \uarr q$ 。即 $p\uarr q\Leftrightarrow \lnot(p\land q)$ 。符号 $\uarr$ 称作**与非联结词**。  
  复合命题“ $p$ 或 $q$ 的否定式”称作 $p,q$ 的**或非式**，记作 $p\darr q$ 。即 $p\darr q\Leftrightarrow \lnot(p\lor q)$ 。符号 $\darr$ 称作**或非联结词**。

- **定理 2.7**  
  $\{\uarr\}, \{\darr\}$ 都是联结词完备集。

> $\lnot p$ $\Leftrightarrow$  
> $\lnot(p\land p)$ $\Leftrightarrow$  
> $p\uarr p$  
>
> $p\land q$ $\Leftrightarrow$  
> $\lnot (p\uarr q)$ $\Leftrightarrow$  
> $(p\uarr q)\uarr (p\uarr q)$
>
> $p\lor q$ $\Leftrightarrow$  
> $\lnot\lnot(p\lor q)$ $\Leftrightarrow$  
> $\lnot(\lnot p\land\lnot q)$ $\Leftrightarrow$  
> $\lnot p\uarr\lnot q$ $\Leftrightarrow$  
> $(p\uarr p)\uarr (q\uarr q)$
>
> $\lnot p$ $\Leftrightarrow$  
> $\lnot (p\lor p)$ $\Leftrightarrow$  
> $p\darr p$
>
> $p\land q$ $\Leftrightarrow$  
> $\lnot(\lnot p\lor \lnot q)$ $\Leftrightarrow$  
> $\lnot p\darr \lnot q$ $\Leftrightarrow$  
> $(p\darr p)\darr (q\darr q)$  
>
> $p\lor q$ $\Leftrightarrow$  
> $\lnot (p\darr q)$ $\Leftrightarrow$  
> $(p\darr q)\darr (p\darr q)$

### 2.4 可满足性问题与消解法

- **消解法**是真值表、主析取范式或主合取范式之外的一种解决可满足性问题的方法。
- 称不含任何文字的简单析取式为**空简单析取式**，记作 $\lambda$ 。规定空简单析取式是不可满足的。

> 空简单析取式不可满足是根据消解法规定的。  
> $p\land \lnot p$ 消解为空（不含任何文字的析取式），而消解前为不可满足的，因此空简单析取式也是不可满足的（也可以从不含任何文字的析取式是不可满足的角度理解）。

- 设 $l$ 是一个文字，记 $l^c=\begin{cases}\lnot p, &若 l=p\\ p, &若 l=\lnot p\end{cases}$ 称作文字 $l$ 的补。

- **定义 2.9**  
  设 $C_1,C_2$ 是两个简单析取式，$C_1$ 含文字 $l$ ，$C_2$ 含 $l^c$ 。从 $C_1$ 中删去 $l$ ，从 $C_2$ 中删去 $l^c$ ，然后再将所得到的结果析取成一个简单析取式，称这样得到的简单析取式为 $C_1,C_2$ 的（以 $l$ 和 $l^c$ 为**消解文字**的） **消解式**或**消解结果**，记为 $Res(C_1,C_2)$ 。即设 $C_1=C_1'\lor l, C_2=C_2'\lor l^c, Res(C_1,C_2)=C_1'\lor C_2'$ 。

> 消解是针对析取式而言的。

- 根据定义 2.9 由 $C_1,C_2$ 得到 $Res(C_1,C_2)$ 的规则称作**消解规则**。

- 如果 $C_1,C_2$ 可对多对文字消解，则其消解结果都是等值的。

> **简单证明**  
> 不妨记 $C_1=A\lor l_1 \lor l_2 \lor ... \lor l_n$，$C_2=B \lor \lnot l_1\lor \lnot l_2\lor ... \lor \lnot l_n$ ，$A,B$ 是不可消解的任意文字，即最多有 $n$ 对文字可以消解。消去 1 对文字之后，由于剩余的可消解的文字对一定有 $l_i\lor \lnot l_i$ 的形式（或者消解结果就只有一个），则一定为永真式，也即所有的消解结果的值相同。  
> **举例**  
> $C_1=p\lor q \lor r$，$C_2=\lnot p\lor \lnot q$，则消去 $p$ ，为 $D_1=q\lor r \lor \lnot q$，消去 $q$ ，则为 $D_2=p\lor r\lor \lnot p$，$D_1,D_2$ 都是永真式。

- **定理 2.8**  
  $C_1\land C_2\approx Res(C_1,C_2)$ 。

> 符号 $\approx$ 表示两端的公式具有相同的可满足性，即  
> 若 $C_1\land C_2$ 可满足，则 $Res(C_1,C_2)$ 可满足；  
> 若 $Res(C_1, C_2)$ 可满足，则 $C_1\land C_2$ 可满足；

> **简单证明**  
> 若 $C_1\land C_2$ 可满足，则 $C_1$ 和 $C_2$ 均可满足，消解过程中，如果消解没有引起不满足条件改变，则消解之后仍可满足，如果消解引起不满足条件改变（满足的文字被消解），假设为 $C_1$ ，则对 $C_2$ ，根据消解的规则（消解的是补），一定不引起满足条件改变，因此消解结果也一定可满足。  
> 若 $Res(C_1,C_2)$ 可满足，则若记 $Res(C_1,C_2)=A_1\lor A_2$ ，$A_1, A_2$ 至少有一个可满足，不妨设 $A_1$ 可满足，再不妨记 $C_1=A_1\lor l$ ，$C_2=A_2\lor l^c$ ，则有 $C_1$ 可满足，此时只要取 $l^c$ 可满足即可。也即 $C_1\land C_2$ 一定可满足。  
> 举例：假设消解结果为 $p\lor \lnot p$ ，则消解前的析取式可以为 $p\lor \lnot q$，$\lnot p\lor q$ ，显然，如果消解结果可以满足，则消解前的析取式一定也可以满足（因为按析取关系增加了一个可满足文字）。

> 可满足性相同，但是不一定等值。

> 这个定理说明，**如果两个公式都是可满足的，则它们的消解结果一定也是可满足的**。**如果消解结果是可满足的，则消解前的两个公式也一定是可满足的**。

- **定义 2.10**  
  设 $S$ 是一个合取范式，$C_1,C_2,...,C_n$ 是一个简单析取式序列。如果对每一个 $i(1\le i\le n)$ ，$C_i$ 是 $S$ 中的一个简单析取式或者 $C_i$ 是它之前的某两个简单析取式 $C_j,C_k(1\le j < k < i)$ 的消解结果，则称此序列是由 $S$ 导出 $C_n$ 的**消解序列**。当 $C_n=\lambda$ 时，称此序列是 $S$ 的一个**否证**。

> 例如，$p\land \lnot p$ 消解为 $\lambda$ ，即不可满足。

- **定义 2.10 推论**  
  如果合取范式 $S$ 有否证，则 $S$ 不是可满足的。

- **引理 2.9**  
  设 $S$ 含有简单析取式 $l$ ，从 $S$ 中删去所有包含 $l$ 的简单析取式，再从剩下的简单析取式中删去 $l^c$ ，把这样得到的合取范式记作 $S'$ ，则 $S\approx S'$ 。

- **定理 2.10**  
  **消解的完全性**。  
  如果合取范式 $S$ 是不可满足的，则 $S$ 有否证。

- **定理 2.10 推论**  
  合取范式 $S$ 是不可满足的当且仅当它有否证。

> **消解算法**  
> 输入：合式公式 $A$ 。  
> 输出：若 $A$ 是可满足的，则回答“yes”；否则回答“no”。
>
> 1. 求 $A$ 的合取范式 $S$
> 2. 令 $S_0$ 和 $S_2$ 为不含任何元素的集合，$S_1$ 为 $S$ 的所有简单析取式组成的集合
> 3. 对 $S_0$ 中的每一个简单析取式 $C_1$ 与 $S_1$ 中的每一个简单析取式 $C_2$
> 4. $~~$如果 $C_1,C_2$ 可以消解，则
> 5. $~~~~$计算 $C=Res(C_1,C_2)$
> 6. $~~~~$如果 $C=\lambda$ ，则
> 7. $~~~~~~$输出 “no”，计算结束
> 8. $~~~~$如果$S_0$与$S_1$都不包含$C$，则
> 9. $~~~~~~$把 $C$ 加入 $S_2$
> 10. 对 $S_1$ 中的每一对子句 $C_1,C_2$
> 11. $~~$如果 $C_1,C_2$ 可以消解，则
> 12. $~~~~$计算 $C=Res(C_1,C_2)$
> 13. $~~~~$如果 $C=\lambda$，则
> 14. $~~~~~~$输出“no”，计算结束
> 15. $~~~~$如果 $S_0$ 与 $S_1$ 都不包含 $C$，则
> 16. $~~~~~~$把 $C$ 加入 $S_2$
> 17. 如果 $S_2$ 中没有任何元素，则
> 18. $~~$输出“yes”，计算结束
> 19. 否则把 $S_1$ 加入 $S_0$，令 $S_1$ 等于 $S_2$ ，清空 $S_2$，返回 3


## 3 命题逻辑的推理理论

### 3.1 推理的形式结构

- **推理**是指从前提出发推出结论的思维过程，**前提**是已知的命题公式集合，**结论**是从前提出发应用推理规则推出的命题公式。

- **定义 3.1**  
  设 $A_1,A_2,...,A_k$ 和 $B$ 都是命题公式，若对于 $A_1,A_2,...,A_k$ 和 $B$ 中出现的命题变项的任意一组赋值，或者 $A_1\land A_2\land ...\land A_k$ 为假，或者当 $A_1\land A_2 \land ... \land A_k$ 为真时 $B$ 也为真，则称由前提 $A_1,A_2,...,A_k$ 推出结论 $B$ 的推理是**有效的**或**正确的**，并称 $B$ 为**有效的结论**。

> 推理错误当且仅当 $A_1\land A_2\land ... \land A_n$ 为假，$B$ 为真。  
> 对于一个正确的推理，如果前提正确，则结论一定正确，如果前提错误，则结论可能正确，也可能错误。  
> 推理的定义是命题公式的集合之间的关系。

- 设前提为集合 $\Gamma$ ，将由 $\Gamma$ 推出 $B$ 的推理记为 $\Gamma \vdash B$ 。若推理是正确的，则记为 $\Gamma \vDash B$ ，否则记为 $\Gamma \nvDash B$ 。这里称 $\Gamma \vdash B$ 或 $\{A_1,A_2,...,A_k\}\vdash B$ 为**推理的形式结构**。

- **定理 3.1**  
  命题公式 $A_1,A_2,...,A_k$ 推出 $B$ 的推理正确当且仅当 $A_1\land A_2\land ... \land A_k\to B$ 为重言式。

> 充分性。$A_1\land A_2\land ... \land A_k\to B$ 为重言式，则对任意赋值，该式为真，即不会出现前真后假的情况，因此符合推理正确的定义。  
> 必要性。若推理正确，则必没有前真后假的情况，因此也即对任意赋值，相应的蕴含式必为真，也即蕴含式为永真式。

- 根据定理 3.1 ，也即 $\{A_1,A_2,...,A_k\}\vDash B$ 等价于 $A_1\land A_2\land ... \land A_k \Rightarrow B$ ，这里 $\Rightarrow$ 为元语言符号，表示蕴含式为重言式。

> 判断推理是否正确，也即判断对应的蕴含式是否为永真式，相应有真值表法、等值演算法、主析取范式法。

> **例**  
> 判断下面的推理是否正确。  
> （1）下午马芳或去看电影或去游泳，她没去看电影，所以，她去游泳了。  
> 分析：  
> 定义命题：  
> $p$：下午马芳去看电影；  
> $q$：下午马芳去游泳；  
> 将推理符号化，为  
> 前提：$((p\land \lnot q)\lor (\lnot p\land q))\land \lnot p$  
> 结论：$q$  
> 推理的形式结构为  
> $E=(((p\land \lnot q)\lor (\lnot p\land q))\land \lnot p)\to q$  
> 判断该式是否为重言式，可以用等值演算法，即  
> $E\Leftrightarrow (\lnot p\land q)\to q$ $\Leftrightarrow$  
> $\lnot (\lnot p\land q)\lor q$ $\Leftrightarrow$  
> $p\lor \lnot q\lor q$ $\Leftrightarrow$  
> $1$
> 也即推理正确。
>
> （2）若下午气温超过 $30$ 摄氏度，则王小燕必去游泳，若她去游泳，她就不去看电影了。所以，若王小燕没去看电影，下午气温必超过了 $30$ 摄氏度。  
> 分析：定义命题：  
> $p$：下午气温超过 30 摄氏度；  
> $q$：王小燕去游泳；  
> $r$：王小燕去看电影；  
> 推理符号化为：  
> 前提：$(p\to q)\land (q \to \lnot r)$  
> 结论：$(\lnot r\to p)$  
> 推理的形式化结构为  
> $E=((p\to q)\land (q \to \lnot r))\to (\lnot r\to p)$  
> 使用等值演算，即  
> $E\Leftrightarrow $  
> $((\lnot p\lor q)\land (\lnot q \lor \lnot r))\to (r\lor p)$ $\Leftrightarrow$  
> $\lnot ((\lnot p\lor q)\land (\lnot q \lor \lnot r))\lor (r\lor p)$ $\Leftrightarrow$  
> $(\lnot (\lnot p\lor q)\lor \lnot (\lnot q\lor \lnot r))\lor (r\lor p)$ $\Leftrightarrow$  
> $((p\land \lnot q)\lor (q\land r))\lor (r\lor p)$ $\Leftrightarrow$  
> $(p\land \lnot q)\lor (q\land r)\lor r\lor p$ $\Leftrightarrow$  
> $p\lor r$  
> 此时，已经可以判断不是重言式（$p=0\land r=0$）。

> **推理定律**  
>
> 序号 | 推理定律 | 名字
> :-: | :- | :-
> 1 | $A\Rightarrow (A\lor B)$ | 附加律
> 2 | $(A\land B)\Rightarrow A$ | 化简律
> 3 | $(A\to B)\land A\Rightarrow B$ | 假言推理
> 4 | $(A\to B)\land \lnot B\Rightarrow \lnot A$ | 拒取式
> 5 | $(A\lor B)\land \lnot B\Rightarrow A$ | 析取三段论
> 6 | $(A\to B)\land (B\to C)\Rightarrow A\to C$ | 假言三段论
> 7 | $(A\Leftrightarrow B)\land (B\Leftrightarrow C)\Rightarrow A\Leftrightarrow C$ | 等价三段论
> 8 | $(A\to B)\land (C\to D)\land (A\lor C)\Rightarrow (B\lor D)$ | 构造性二难
> 8.1 | $(A\to B)\land (\lnot A\to B)\Rightarrow B$ | 构造性二难（特殊形式）
> 9 | $(A\to B)\land (C\to D)\land (\lnot B\lor \lnot D)\Rightarrow (\lnot A\lor \lnot C)$ | 破坏性二难

> **证明示例**：
>
> 对 $(A\lor B)\land \lnot B\Rightarrow A$ ，替换为 $(p\lor q)\land \lnot q\to p$ 永真，  
> 记为 $E\Leftrightarrow$  
> $\lnot ((p\lor q)\land \lnot q)\lor p$ $\Leftrightarrow$  
> $(\lnot p\land \lnot q)\lor q\lor p$ $\Leftrightarrow$  
> $(\lnot p\lor q)\lor p$ $\Leftrightarrow$  
> $1$  
> 即永真成立。

### 3.2 自然推理系统 $P$

- **证明**是一个描述推理过程的命题公式序列，其中的每个公式或者是已知前提，或者是由前面的公式应用推理规则得到的结论（中间结论或推理中的结论）。

- **定理 3.2**  
  一个形式系统 $I$ 由下面 $4$ 个部分组成。  
  （1）非空的**字母表** $A(I)$ 。  
  （2）$A(I)$ 中符号构造的**合式公式集** $E(I)$ 。  
  （3）$E(I)$ 中一些特殊的公式组成的**公理集** $A_X(I)$ 。  
  （4）**推理规则集** $R(I)$ 。  
  将 $I$ 记为 $4$ 元组 $<A(I),E(I),A_X(I),R(I)>$ 。其中 $<A(I),E(I)>$ 是 $I$ 的**形式语言系统**，而 $<A_X(I),R(I)>$ 为 $I$ 的**形式演算系统**。

- 形式系统一般分为两类，分别是**自然推理系统**和**公理推理系统**。自然推理系统的特点是从任意给定的前提出发，应用系统中的推理规则进行推理演算，最后得到的命题公式是推理的结论（不一定是重言式）。公理推理系统的特点是只能从若干给定的公理出发，应用系统中的推理规则进行推理演算，得到的结论是系统中的重言式，称为系统中的**定理**。

- **定理 3.3**  
  自然推理系统 $P$ 的定义如下：  
  1. 字母表  
  （1）命题变项符号：$p,q,r,...,p_i,q_i,r_i,...$  
  （2）联结词符号：$\lnot ,\land,\lor,\to,\leftrightarrow$  
  （3）括号与逗号：$) ( ,$  
  2. 合式公式  
  参考定义 1.6 （单个命题变项以及有限次联结）。  
  3. 推理规则  
  （1）前提引入规则：在证明的任何步骤都可以引入前提；  
  （2）结论引入规则：在证明的任何步骤所得到的结论都可以作为后继证明的前提；  
  （3）置换规则：在证明的任何步骤，命题公式中的子公式都可以用等值的公式置换，得到公式序列中的又一个公式；  
  （4）根据 9 条推理定律以及结论引入规则，可以相应导出 9 条推理规则。  

- 设前提 $A_1,A_2,...,A_k$ ，结论 $B$ 和公式序列 $C_1,C_2,...,C_l$ ，如果每一个 $i$ ，$C_i$ 是某个 $A_j$ ，或者可由序列中前面的公式应用推理规则得到，并且 $C_l=B$ ，则称公式序列 $C_1,C_2,...,C_l$ 是由 $A_1,A_2,...,A_k$ 推出 $B$ 的一个**证明**。

> **附加前提证明法**  
> $(A_1\land A_2\land ...\land A_k)\to (A\to B)$ $\Leftrightarrow$  
> $(A_1\land A_2\land ...\land A_k\land A)\to B$  
> 也即如果结论是蕴含式，则可以将结论中的蕴含式的前件也作为推理的前提。  
> 证明：  
> $(A_1\land A_2\land ...\land A_k)\to (A\to B)$ $\Leftrightarrow$  
> $\lnot (A_1\land A_2\land ...\land A_k)\lor (\lnot A\lor B)$ $\Leftrightarrow$  
> $(A_1\land A_2\land ...\land A_k\land A)\to B$  

> **归谬法**  
> $(A_1\land A_2\land ... \land A_k)\to B$ $\Leftrightarrow$  
> $(A_1\land A_2\land ...\land A_k\land \lnot B)$ 为矛盾式。  
> 也即如果将结论的反面作为前提进行推理能得到矛盾式，则推理正确。  
> 证明：  
> $(A_1\land A_2\land ... \land A_k)\to B$ $\Leftrightarrow$  
> $\lnot (A_1\land A_2\land ... \land A_k)\lor B$ $\Leftrightarrow$  
> $\lnot (A_1\land A_2\land ... \land A_k \land \lnot B)$  
> 如果 $\lnot (A_1\land A_2\land ... \land A_k \land \lnot B)$ 为矛盾式，则原式为永真式。  

### 3.3 消解证明法

- **消解证明法**：  
  根据归谬法，将结论的反面和前提化为合取范式，然后通过消解规则，如果消解出空，则为矛盾式，相应的推理就得到证明。

## 4 一阶逻辑基本概念

- 命题逻辑具有一定的局限性，甚至无法判断一些常见的简单推理。为了命题逻辑的这种局限性，需要引入**量词**，以期达到表达出**个体**与**总体**之间的内在联系和数量关系，这就是**一阶逻辑**所研究的内容。一阶逻辑也称作**一阶谓词逻辑**或**谓词逻辑**。

### 4.1 一阶命题符号化

- **个体词、谓词和量词是一阶逻辑命题符号化的 3 个基本要素**。  

> 一阶逻辑命题举例：所有偶数都是整数。“所有···都···”是量词，“偶数”是个体词，“是整数”是谓词。

- **个体词**是指所研究对象中可以独立存在的具体的或抽象的客体。
- 将表示具体或特定的客体的个体词称作**个体常项**，一般用小写英文字母 $a,b,c$ 表示。将表示抽象或泛指的个体词称作**个体变项**，常用 $x,y,z$ 表示。称个体变项的取值范围为**个体域**（或**论域**）。

> 对陈述 “$\sqrt{2}$ 是偶数”。其中，$\sqrt{2}$ 是个体常项，“是偶数”是谓词常项。  
> 对陈述 “$x$ 是偶数”。其中，$x$ 是个体变项。对于 $x$ ，可以规定个体域为“所有整数”。

- 有一个特殊的个体域，它是由宇宙间一切事物组成的，称作**全总个体域**。
- **谓词**是用来刻画个体词性质及个体词之间相互关系的词，常用 $F,G,H$ 等表示。
- 表示具体性质或关系的谓词称作**谓词常项**，表示抽象的或泛指的性质或关系的谓词称作**谓词变项**。

> “所有偶数和整数都满足关系 $L$ ”，其中“满足关系 $L$” 是谓词变项。

- 一般地，含 $n(n\ge 1)$ 个个体变项 $x_1,x_2,...,x_n$ 的谓词 $P$ 称作 $n$ **元谓词**。记作 $P(x_1,x_2,...,x_n)$ 。当 $n=1$ 时，表示 $x_1$ 具有性质 $P$ ，当 $n> 1$ 时，表示 $x_1,x_2,...,x_n$ 具有关系 $P$ 。

> 陈述“$x$ 是偶数”，只有一个个体变项，即表示 $x$ 具有一项性质，是偶数。  
> 陈述“$x$ 比 $y$ 大”，有两个个体变项，即表示 $x,y$ 满足一个关系，$x$ 比 $y$ 大。  

- $n$ 元谓词的定义域是个体域，值域是 $\{0,1\}$ 。
- 将不带个体变项的谓词称作 $0$ **元谓词**。当为谓词常项时，$0$ 元谓词为命题。

> **例**  
> 将命题用 $0$ 元谓词符号化  
> 只有 $2$ 是素数，$4$ 才是素数。  
> 析：  
> 设 $1$ 元谓词 $F(x)$：$x$ 是素数，命题可以符号化为  
> $F(4)\to F(2)$  

- 表示个体常项或变项之间数量关系的词称作**量词**。量词有**全称量词**和**存在量词**两种。
- **全称量词**用符号 $\forall$ 表示，$\forall x$ 表示个体域里的所有个体 $x$ ，其中个体域是事先约定的。

> 全称量词的**描述示例**：  
> “一切的”，  
> “所有的”，  
> “每一个”，  
> “任意的”，  
> “凡”，  
> “都”  

> 全称量词**符号示例**：  
> $\forall xF(x)$ 表示个体域里所有 $x$ 具有性质 $F$ ；  
> $\forall x\forall yG(x,y)$ 表示个体域里所有个体 $x,y$ 都有关系 $G$ 。

- **存在量词**用符号 $\exist$ 表示，$\exist x$ 表示个体域里有一个个体 $x$ 。

> 存在量词的**描述示例**：  
> “存在”，  
> “有一个”，  
> “有的”，  
> “至少有一个”，  

> 存在量词**符号示例**：  
> $\exist xF(x)$ 表示个体域中存在 $x$ 具有性质 $F$ ；  
> $\exist x\exist yG(x,y)$ 表示个体域中存在 $x,y$ 满足关系 $G$ ；

> 全称量词和存在量词可以组合使用  
> $\forall x\exist yG(x,y)$ 表示个体域中，所有 $x$ ，存在 $y$ ，满足关系 $G$ 。

> **命题符号化示例**  
>
> （1）凡人都呼吸，个体域 $D_1$ 为人类集合。  
> 个体域中除人外，再没有其它对象。记 $F(x)$：$x$ 呼吸。命题符号化为 $\forall xF(x)$ 。
> （2）凡人都呼吸，个体域 $D_2$ 为全总个体域。  
> 个体域中除人外，还有其它对象，因此要先给定谓词，将人从全总个体域中分离出来，可以取 $G(x)$：$x$ 是人，再取 $F(x)$：$x$ 呼吸。则命题符号化为 $\forall (G(x)\to F(x))$ 。  
> （3）有的人用左手写字。个体域 $D_1$ 为人类集合。  
> 个体域中只有人，因此是存在量词。记 $F(x)$：$x$ 用左手写字。命题符号化为 $\exist x F(x)$ 。  
> （4）有的人用左手写字。个体域 $D_2$ 为全总个体域。  
> 先从个体域中分离出人。取 $G(x)$：$x$ 是人。则命题符号化为 $\exist x(G(x)\to F(x))$ 。  

### 4.2 一阶逻辑公式及其解释

- **一阶语言**，适用于一阶逻辑的形式语言，一阶逻辑是建立在一阶语言上的逻辑体系。
- **非逻辑符号**：个体常项符号，函数符号，谓词符号。  
- **逻辑符号**：个体变项符号，量词符号，联结词符号，括号，逗号。
- **定义 4.1**  
  设 $L$ 是一个非逻辑符号集合，由 $L$ 生成的一阶语言 $\mathscr{L}$ 的**字母表**包括下述符号。  
  非逻辑符号  
  （1）$L$ 中的个体常项符号，常用 $a,b,c,...$ 或 $a_i,b_i,c_i,...(i\ge 1)$ 表示。  
  （2）$L$ 中的函数符号，常用 $f,g,h,...$ 或 $f_i,g_i,h_i,...(i\ge 1)$ 表示。  
  （3）$L$ 中的谓词符号，常用 $F,G,H,...$ 或 $F_i,G_i,H_i,...(i\ge 1)$ 表示。  
  逻辑符号  
  （4）个体变项符号：$x,y,z,...,x_i,y_i,z_i,...(i\ge 1)$ 。  
  （5）量词符号：$\forall, \exist$  
  （6）联结词符号：$\lnot,\land,\lor,\to,\leftrightarrow$ 。  
  （7）括号与逗号：$)(,$  

- **定义 4.2**
  $\mathscr{L}$ 的**项**定义如下：  
  （1）个体常项符号和个体变项符号是项。  
  （2）若 $\varphi(x_1,x_2,...,x_n)$ 是 $n$ 元函数符号，$l_1,l_2,...,l_n$ 是 $n$ 个项，则 $\varphi(l_1,l_2,...,l_n)$ 是项。  
  （3）所有的项都是有限次地使用（1）（2）得到的。

- **定义 4.3**  
  设 $R(x_1,x_2,...,x_n)$ 是 $\mathscr{L}$ 的 $n(n\ge 1)$ 元谓词符号，$t_1,t_2,...,t_n$ 是 $\mathscr{L}$ 的 $n$ 个项，则称 $R(t_1,t_2,...,t_n)$ 是 $\mathscr{L}$ 的**原子公式**。

- **定义 4.4**  
  $\mathscr{L}$ 的**合式公式**定义如下：  
  （1）原子公式是合式公式  
  （2）若 $A$ 是合式公式，则 $(\lnot A)$ 也是合式公式。  
  （3）若 $A,B$ 是合式公式，则 $(A\land B),(A\lor B),(A\to B),(A\leftrightarrow B)$ 也是合式公式。  
  （4）若 $A$ 是合式公式，则 $\forall xA,\exist xA$ 也是合式公式。  
  （5）只有有限次地应用（1）～（4）构成的符号串才是合式公式。  

- $\mathscr{L}$ 的合式公式也称**谓词公式**，简称**公式**。
- **定义 4.5**  
  在公式 $\forall xA$ 和 $\exist xA$ 中，称 $x$ 为**指导变元**，$A$ 为量词的**辖域**，在 $\forall x$ 和 $\exist x$ 的辖域中，$x$ 的所有出现都称作**约束出现**，$A$ 中不是约束出现的其它变项均称作**自由出现**。

> 对 $\forall x(F(x,y)\to G(x,z))$  
> 指导变元为 $x$  
> 辖域为 $A=F(x,y)\to G(x,z)$  
> $x$ 约束出现两次，$y,z$ 各自由出现一次。  

- **定义 4.6**  
  设 $A$ 是任意的公式，若 $A$ 中不含自由出现的个体变项，则称 $A$ 为**封闭的公式**，简称作**闭式**。

> 对公式中所有自由出现的个体变项添加量词即产生封闭的公式。

- 对公式中个体域、个体常项符号、函数符号、谓词符号的指定称作**解释**，指定自由出现的个体变项的值称作**赋值**。

- **定义 4.7**  
  设 $\mathscr{L}$ 是由 $L$ 生成的一阶语言，$\mathscr{L}$ 的**解释** $I$ 由以下部分组成。  
  （1）非空个体域 $D_I$  
  （2）对每一个个体常项符号 $a\in L$ ，有一个 $\overline{a}\in D_I$ ，称 $\overline{a}$ 为 $a$ 在 $I$ 中的解释。
  （3）对每一个 $n$ 元函数符号 $f\in L$ ，有一个 $D_I$ 上的 $n$ 元函数 $\overline{f}:D_I^n\to D_I$ ，称 $\overline{f}$ 为 $f$ 在 $I$ 中的解释。  
  （4）对每一个 $n$ 元谓词符号 $F\in L$ ，有一个 $D_I$ 上的 $n$ 元谓词常项 $\overline{F}$ ，称 $\overline{F}$ 为 $F$ 在 $I$ 中的解释。

- 设公式 $A$ ，规定：在解释 $I$ 和赋值 $\sigma$ 下，  
  1. 取个体域 $D_I$ ，
  2. 若 $A$ 中含个体常项符号 $a$ 就将它替换成 $\overline{a}$ ，
  3. 若 $A$ 中含函数符号 $f$ 就将它替换成 $\overline{f}$ ，
  4. 若 $A$ 中含谓词符号 $F$ 就将它替换成 $\overline{F}$ ，
  5. 若 $A$ 中含自由出现的个体变项符号 $x$ 就将它替换成 $\sigma(x)$ ，  
  把这样得到公式记作 $A'$ ，称 $A'$ 为 $A$ 在 $I$ 和 $\sigma$ 下的**解释**，或 $A$ 在 $I$ 和 $\sigma$ 下**被解释成** $A'$ 。

- **定义 4.8**  
  设 $A$ 为一公式，若 $A$ 在任何解释和该解释下的任何赋值下均为真，则称 $A$ 为**永真式**（或**逻辑有效式**）。若 $A$ 在任何解释和该解释下的任何赋值下均为假，则称 $A$ 为**矛盾式**（或**永假式**）。若至少存在一个解释和该解释下的一个赋值使 $A$ 为真，则称 $A$ 是**可满足式**。

> 在命题逻辑中，可以用真值表等方法判断任意给定的公式是否是可满足的。对于一阶逻辑，情况则不同。由于公式中的谓词和函数可以有各种不同的解释，使得情况变得宜昌复杂，解释是判断任意给定的公式是否是可满足的的问题是不可判定的，即**不存在一个算法能在有限步内判断任意给定的公式是否是可满足的**。因此对于一阶命题逻辑，仅讨论一些简单的情况。

- **定义 4.9**  
  设 $A_0$ 是含命题变项 $p_1,p_2,...,p_n$ 的命题公式，$A_1,A_2,...,A_n$ 是 $n$ 个谓词公式，用 $A_i(1\le i\le n)$ 处处代替 $A_0$ 中的 $p_i$ ，所得公式 $A$ 称为 $A_0$ 的**代换实例**。

> 如 $p\to q$ 可以代换得到 $F(x)\to G(x)$ ，或者代换得到 $\forall xF(x)\to \exist yG(y)$ 。

- **定理 4.1**  
  重言式的代换实例都是永真式，矛盾式的代换实例都是矛盾式。

> 注：这个定理记住结论即可，书中证明略。

> **例 4.9**  
> 判断下列公式中，哪些是永真式，哪些是矛盾式？  
> （1）$\forall x(F(x)\to G(x,y))$  
> （2）$\forall xF(x)\to (\exist x\exist yG(x,y)\to \forall x F(x))$  
> 析：  
> （1）解释 1：$x,y$ 为整数， $F(x)$： $x$ 是整数，$G(x,y)$：$x,y$ 是小数。则 $F(x)$ 为真，$G(x,y)$ 为假，即公式为假。解释 2：$x,y$ 为整数，$F(x)$：$x$ 是整数，$G(x,y)$：$x,y$ 是整数。则 $F(x)$ 为真， $G(x,y)$ 为真，即公式为真。因此公式是非永真式的可满足式。  
> （2）$p\to (q\to p)\Leftrightarrow$  
> $\lnot p\lor (\lnot q\lor p)$ $\Leftrightarrow$  
> $1$  
> 也即对应的命题公式为真，因此该谓词公式为永真式。

## 5 一阶逻辑等值演算与推理

### 5.1 一阶逻辑等值式与置换规则

- **定义 5.1**  
  设 $A,B$ 是一阶逻辑中任意两个公式，若 $A\leftrightarrow B$ 是永真式，则称 $A$ 与 $B$ 等值，记作 $A\Leftrightarrow B$ 。称 $A\Leftrightarrow B$ 是**等值式**。

> **基本等值式**  
>
> 1. **命题公式中的重言式通过替换形成逻辑公式中的永真式**。  
> 例如：  
> $p\Leftrightarrow \lnot\lnot p$，替换得到 $\forall xF(x)\Leftrightarrow \lnot\lnot\forall xF(x)$  
> 2. **量词否定等值式**  
> 设 $A(x)$ 含自由出现的个体变项 $x$ ，则  
> （1）$\lnot \forall xA(x)$ $\Leftrightarrow$ $\exist x\lnot A(x)$  
> 即 “不是所有 $x$ 都满足 $A(x)$” 等价于 “存在 $x$ 不满足 $A(x)$” 。  
> **如何证明？**  
> （2）$\lnot \exist xA(x)\Leftrightarrow \forall x\lnot A(x)$  
> 即 “不存在 $x$ 满足 $A(x)$” 等价于 “所有 $x$ 都不满足 $A(x)$”  
> 3. **量词辖域收缩域扩张等值式**  
> 设公式 $A(x)$ 含自由出现的个体变项 $x$ ，$B$ 不含 $x$ 的自由出现，则  
> （1）$\forall x(A(x)\lor B)\Leftrightarrow \forall x(A(x)\lor B)$  
> （2）$\forall x(A(x)\land B)\Leftrightarrow \forall x(A(x)\land B)$  
> （3）$\forall x(A(x)\to B)\Leftrightarrow \exist x A(x)\to B)$  
> （4）$\forall x(B\to A(x))\Leftrightarrow B\to \exist xA(x)$  
> （5）$\exist x(A(x)\lor B)\Leftrightarrow \exist xA(x)\lor B$  
> （6）$\exist x(A(x)\land B)\Leftrightarrow \exist xA(x)\land B$  
> （7）$\exist xA(x)\to B\Leftrightarrow \forall xA(x)\to B$  
> （8）$\exist x(B\to A(x))\Leftrightarrow B\to \exist xA(x)$
> 3. **量词分配等值式**  
> 设公式 $A(x),B(x)$ 含自由出现的个体变项 $x$ ，则  
> （1）$\forall x(A(x)\land B(x))$  
> （2）$\exist x(A(x)\lor B(x))\Leftrightarrow \exist xA(x)\lor \exist xB(x)$

> 1. **置换规则**  
> 设 $\Phi(a)$ 是含公式 $A$ 的公式，$\Phi(B)$ 是用公式 $B$ 取代 $\Phi(A)$ 中所有的 $A$ 后所得到的公式，那么，若 $A\Leftrightarrow B$ ，则 $\Phi(A)\Leftrightarrow \Phi(B)$ 。  
> 与命题逻辑中的置换规则相比，置换对象由命题公式变为一阶逻辑公式。
> 2. **换名规则**  
> 设 $A$ 为一公式，将 $A$ 中某量词辖域中的一个约束变项的所有出现及相应的指导变元全部改成该量词辖域中未曾出现过的某个个体变项符号，公式中其余部分不变，将所得公式记作 $A'$，则 $A'\Leftrightarrow A$ 。  
> 也即量词辖域中的名字只在辖域内有效。

### 5.2 一阶逻辑前束范式

- **定义 5.2**  
  具有如下形式 $Q_xx_1Q_2x_2...Q_kx_kB$ 的一阶逻辑公式称作**前束范式**，其中 $Q_i(1\le i \le k)$ 为 $\forall$ 或 $\exist$ ，$B$ 为不含量词的公式。

> 前束范式只有一个量词作用范围。

> 前束范式举例：  
> $\forall x\forall y(F(x)\land G(y)\to H(x,y))$  
> $\forall x\forall y\exist z(F(x)\land G( y)\land G(z)\to L(x,z))$

- **定理 5.1**  
  **前束范式存在定理**  
  一阶逻辑中的任何公式都存在等值的前束范式。

### 5.3 一阶逻辑的推理理论

- 在一阶逻辑中，从前提 $A_1,A_2,...,A_k$ 出发推出结论 $B$ 的推理的形式结构，依然采用如下的蕴含式 $A_1\land A_2\land ... \land A_k\to B$ 。若其为永真式，则称**推理正确**，否则称**推理不正确**。
- 在一阶逻辑中称永真式的蕴含式为**推理定律**。若一个推理的形式结构时推理定律，则这个推理时正确的。

> 推理定律的来源。  
> **一、命题逻辑推理定律的代换实例**  
> 如  
> $\forall xF(x)\land \forall yG(y)\Rightarrow \forall xF(x)$  
> $\forall xF(x)\Rightarrow \forall xF(x)\lor \exist yG(y)$  
> **二、由基本等值式生成的推理定律**  
> 如由双重否定律有  
> $\forall xF(x)\Rightarrow \lnot\lnot \forall xF(x)$  
> $\lnot\lnot \forall xF(x)\Rightarrow \forall xF(x)$  
> 由量词否定等值式可以生成  
> $\lnot \forall xF(x)\Rightarrow \exist x\lnot F(x)$  
> $\exist x\lnot F(x)\Rightarrow \lnot \forall xF(x)$  
> **三、一些常用的重要推理定律**  
>
> 1. $\forall xA(x)\lor \forall xB(x)\Rightarrow \forall x(A(x)\lor B(z))$  
> 2. $\exist (A(x)\land B(x))\Rightarrow \exist xA(x)\land \exist xB(x)$  
> 3. $\forall x(A(x)\to B(x))\Rightarrow \forall xA(x)\to \forall xB(x)$  
> 4. $\forall x(A(x)-B(x))\Rightarrow \exist xA(x)\to \exist xB(x)$

> 全称量词和存在量词的消去和引入规则。  
> 前提：$\Gamma=\{A_1,A_2,...,A_k\}$  
>
> **一、全称量词消去规则**（记为 $\forall -$）  
> $\displaystyle\frac{\forall xA(x)}{\therefore A(y)}$ 或 $\displaystyle\frac{\forall xA(x)}{\therefore A(c)}$  
其中，$x,y$ 是个体变项符号，$c$ 是个体常项符号，且在 $A$ 中 $x$ 不在 $\forall y$ 和 $\exist y$ 的辖域内自由出现。  
> **二、全称量词引入规则**（记为 $\forall +$）  
> $\displaystyle \frac{A(y)}{\therefore \forall xA(x)}$  
> **三、存在量词消去规则**（记为 $\exist -$）  
> 已知 $\exist xA(x)$  
> $\displaystyle \frac{A(y)\to B}{\therefore B}$ 或 $\displaystyle \frac{A(y)\to B}{\therefore \exist xA(x)\to B}$  
>
> 已知 $\exist xA(x)$  
> $\displaystyle \frac{A(c)\to B}{\therefore B}$ 或 $\displaystyle \frac{A(c)\to B}{\therefore \exist xA(x)\to B}$  
> **四、存在量词引入规则**（记为 $\exist +$）  
> $\displaystyle \frac{A(y)}{\therefore \exist xA(x)}$ 或 $\displaystyle \frac{B\to A(y)}{\therefore B\to \exist xA(x)}$
>
> $\displaystyle \frac{A(c)}{\therefore \exist xA(x)}$ 或 $\displaystyle \frac{B\to A(c)}{\therefore B\to \exist xA(x)}$

- **定义 5.3** **自然推理系统** $N_{\mathscr{L}}$ 定义如下。  

1. 字母表。同一阶语言 $\mathscr{L}$ 的字母表。
2. 合式公式。同 $\mathscr{L}$ 的合式公式的定义。
3. 推理规则：  
（1）前提引入规则。  
（2）结论引入规则。  
（3）置换规则。  
（4）假言推理规则。  
（5）附加规则。  
（6）化简规则。  
（7）拒取式规则。  
（8）假言三段论规则。  
（9）析取三段论规则。  
（10）构造性二难推理规则。  
（11）合取引入规则。  
（12）$\forall -$ 规则。  
（13）$\forall +$ 规则。  
（14）$\exist -$ 规则。  
（15）$\exist +$ 规则。  

- 在推理系统 $N_\mathscr{L}$ 种推理的证明与自然推理系统 $P$ 中推理的证明相同。设前提 $A_1,A_2,...,A_k$ ，结论 $B$ 和公式序列 $C_1,C_2,...,C_l$ 。如果每一个 $i(i=1,2,...,l)$ ，$C_i$ 是某个 $A_j$ ，或者可以由序列前面的公式应用图例规则得到，并且 $C_l=B$ ，则称公式序列 $C_1,C_2,...,C_l$ 是由 $A_1,A_2,...,A_k$ 推出的**证明**。

> **例 5.9** 在自然推理系统 $N_{\mathscr{L}}$ 中，构造下面推理的证明。  
> 任何自然数都是整数。存在自然数。所以，存在着整数。个体域为实数集合 $\boldsymbol{R}$ 。  
> 解：  
> 设 $F(x):x$ 为自然数，$G(x):x$ 为整数。  
> 前提：$\forall x(F(x)\to G(x)),\exist xF(x)$  
> 结论：$\exist xG(x)$  
> 证明：  
> $\forall x(F(x)\to G(x))$  
> $F(x)\to G(x)$ $去掉全称量词$  
> 

## 6 集合代数

关于集合论：  

集合论是基本的数学描述工具。  

- 集合是数学中的基本概念  
- 诞生于十九世纪  
- 创始人是康托  

集合论体系：  

- 朴素集合论（教材中涉及的都是朴素集合论）  
- 公理集合论

### 6.1 集合的基本概念

- 集合是不能精确定义的基本概念。直观地说，把一些事物汇集到一起组成一个整体就称作**集合**，而这些事物就是这个集合的**元素**或**成员**。  
- 教材中采用的体系中规定集合的元素都是集合。元素和集合之间的关系是隶属关系，即**属于**或**不属于**，记作 $\in$ 和 $\not\in$ 。  
- 通常用大写的英文字母来表示集合。  
- 有两种表示集合的方法：列举法和描述法。列举法列举出集合中的元素，描述法给出元素应该满足的性质。例如：  
$A=\{0,1,2,...\}$  
$B=\{x|x\in \bold{R}\land x>2\}$

- 常用集合：  
  - $\bold{N}$：自然数集  
  - $\bold{Z}$：整数集  
  - $\bold{Q}$：有理数集  
  - $\bold{R}$：实数集  
  - $\bold{C}$：复数集  

- **定义 6.1** 设 A，B 为集合，如果 B 中的每个元素都是 A 中的元素，则称 B 是 A 的**子集合**，简称为**子集**。这时也称 **B 被 A 包含**，或 **A 包含 B**，记作 $B\subseteq A$ 。  
- 如果 B 不被 A 包含，则记作 $B\nsubseteq A$ 。  

注：两个集合之间的关系是包含和不包含的关系，集合与其元素之间的关系是属于和不属于的关系。  

- $B\subseteq A \Leftrightarrow \forall x(x\in B\rightarrow x\in A)$  

- **定义 6.2** 设 A，B 为集合，如果 $A\subseteq B$ 且 $B\subseteq A$ ，则称 A 与 B 相等，记作 $A=B$ 。  
- 如果 A 与 B 不相等，则记作 $A\ne B$ 。
- **定义 6.3** 设 A，B 为集合，如果 $A\subseteq B$ 且 $B\ne A$ ，则称 B 是 A 的真子集，记作 $B\subset A$ 。  
- 如果 B 不是 A 的真子集，则记作 $B \not\subset A$ 。  
- **定义 6.4** 不含任何元素的集合称为**空集**，记作 $\empty$ 。  
- $\empty=\{x|x\ne x\}$  
- **定理 6.1** 空集是一切集合的子集。  
  $\empty\subseteq A\Leftrightarrow \forall x(x\in \empty \rightarrow x\in A)$ ，由于 $x\in \empty$ 为假，因此右侧蕴含式为重言式，即得证。  
- **推论** 空集是唯一的。  
  即不存在 $\empty_1$ 和 $\empty_2$ ，满足 $\empty_1\ne \empty_2$ 。  
  由定理 6.1，有 $\empty_1\subseteq \empty_2$ 且 $\empty_2\subseteq \empty_2$ ，即有 $\empty_1=\empty_2$ 。  

- 含有 n 个元素的集合简称为 **n 元集**，它的含有 $m(m\le n)$ 个元素的子集称作它的 **m 元子集**。  
- 对于一个 n 元集，其有 $C_n^0$ 个 0 元子集（即一个，为 $\empty$），$C_n^i$ 个 i 元子集，子集的总数为 $C_n^0+C_n^1+...+C_n^n=2^n$ 。  
- **定义 6.5** 设 A 为集合，把 A 的全体子集构成的集合称作 A 的**幂集**，记作 $P(A)$ （或 $\mathscr{P}A,2^A$） 。  
  $P(A)=\{x|x\subseteq A\}$  
- **定义 6.6** 在一个具体的问题中，如果所涉及的集合都是某个集合的子集，则称这个集合为**全集**，记作 E 。  
  全集具有相对性，不同的问题具有不同的全集，同一个问题也可以取不同的全集。  

### 6.2 集合的运算

- **定义 6.7** 设 A，B 为集合，A 与 B 的**并集** $A\cup B$ 、**交集** $A\cap B$ ，B 对 A 的**相对补集** $A-B$ 分别定义如下：  
  $A\cup B=\{x|x\in A\lor  x\in B\}$  
  $A\cap B=\{x|x\in A \land x\in B\}$  
  $A-B=\{x|x\in A\land x\not\in B\}$  

- 如果两个集合的交集为 $\empty$ ，则称这两个集合是**不交**的。  

- 并、交运算可以推广到 n 个集合，并记作  
  $\displaystyle\bigcup_{i=1}^{n}A_i=A_1\cup A_2\cup ... \cup A_n$  
  $\displaystyle\bigcap_{i=1}^{n}A_i=A_1\cap A_2\cap ... \cap A_n$  

- **定义 6.8** 设 A，B 为集合，A 与 B 的对称差集 $A\oplus B$ 定义为  
  $A\oplus B=(A-B)\cup (B-A)$  
  对称差集的另一种定义是  
  $A\oplus B=(A\cup B)-(A\cap B)$  
  可以证明这两种定义是等价的：  
  $(A-B)\cup (B-A)$  
  $\Leftrightarrow \{x| (x\in A\land x\not\in B)\lor (x\not\in A\land x\in B)\}$  
  $\Leftrightarrow\{x|(x\in A\lor x\not\in A)\land (x\in A\lor x\in B)\land (x\not\in B\lor x\not\in A)\land( x\not\in B\lor  x\in B)\}$  
  $\Leftrightarrow \{x|(x\in A\lor x\in B)\land (x\not \in B\lor x\not\in B)\}$  
  $(A\cup B)-(A\cap B)$  
  $\Leftrightarrow \{x|(x\in A\lor x\in B)\land \lnot(x\in A\land x\in B)\}$  
  $\Leftrightarrow \{x|(x\in A\lor x\in B)\land (x\not\in A\lor x\not\in B)\}$  
  因此两种定义等价。  

- **定义 6.9** 给定全集 E，A 的**绝对补集**为  
  $\backsim A=E-A=\{x|x\not\in A\}$  

- **定义 6.10** 设 A 为集合，A 的元素的元素构成的集合称作 A 的**广义并**，记作 $\cup A$ ，符号化表示为  
  $\cup A=\{x|\exist z(z\in A\land x\in z)\}$  

若 $A=\{A_1,A_2,...,A_n\}$ ，则 $\cup A=A_1\cup A_2\cup ... \cup A_n$  

- **定义 6.11** 设 A 为非空集合，A 的所有元素的公共元素构成的集合称作 A 的**广义交**，记作 $\cap A$ ，符号化表示为 $\cap A=\{x|\forall z(z\in A\to z\in z)\}$  

- **优先级**规定  
  - 称广义并、广义交、幂集、绝对补运算为一类运算，并、交、相对补、对称差运算为二类运算。  
  - 一类匀速那优先于二类运算。  
  - 一类运算之间由右向左顺序进行。  
  - 二类运算之间由括号决定先后顺序。  

### 6.3 有穷集的计数

- 集合之间的关系和初级运算可以用**文氏图**（Venn diagram）给予形象的描述。  
  首先画一个大矩形表示全集 E（有时为简单起见可以省略），其次在矩形内画一些圆，用圆的内部表示集合。不同的圆代表不同的集合。如果没有关于集合不交的说明，任何两个圆应彼此相交。  

- 用 $|T|$ 表示有穷集 T 中的元素数。  

- **定理 6.2** （**包含排斥原理**） 设 S 为有穷集，$P_1,P_2,...,P_n$ 是 n 个性质。S 中的任何元素 x 或者具有性质 $P_i$ ，或者不具有性质 $P_i$ ，两种情况必居其一。令 $A_i$ 表示 S 中具有性质 $P_i$ 的元素构成的子集，则 S 中不具有性质 $P_1,P_2,...,P_n$ 的元素数为  
  $|\overline{A_1}\cap \overline{A_2}\cap ... \cap\overline{A_n}|$  
  $=|S|-\displaystyle\sum_{i=1}^{n}|A_i|+\displaystyle\sum_{1\le i < j\le n}|A_i\cap A_j|-$  
  $\displaystyle\sum_{1\le i<j < k \le n}|A_i\cap A_j\cap A_k|+...+(-1)^n|A_1\cap A_2\cap ... \cap A_n|$  

  这个定理可以举特例来理解，当 n=1 时，只有一个性质集，因此直接减去即可，即减了一次。当 n=2 时，减去两个集，就将其交集多减了一次，因此最后要加上交集，即减一次，加一次。当 n=3 时，看作三个透明玻璃叠加，将三个性质集都减去，则出去三个相交的两两相交集各被多减去一次，三个相交集被多减去两次，将每个两两相交集都加回来，此时三个相交集就多加了一次，最终减去即可，也即减（三个性质集）、加（两两相交集）、减（三个相交集）。  

### 6.4 集合恒等式

- **幂等律**  
  $A\cup A=A$  
  $A\cap A=A$
- **结合律**  
  $(A\cup B)\cup C=A\cup (B\cup C)$  
  $(A\cap B)\cap C=A\cap (B\cap C)$  
- **交换律**  
  $A\cup B=B\cup A$  
  $A\cap B=B\cap A$  
- **分配律**  
  $A\cup (B\cap C)=(A\cup B)\cap (A\cup C)$  
  $A\cap (B\cup C)=(A\cap B)\cup (A\cap C)$  
- **同一律**  
  $A\cup \empty=A$  
  $A\cap E=A$  
- **零律**  
  $A\cup E=E$  
  $A\cap \empty=\empty$  
- **排中律**  
  $A\cup \sim A=E$  
- **矛盾律**  
  $A\cap \sim A=\empty$  
- **吸收律**  
  $A\cup (A\cap B)=A$  
  $A\cap (A\cup B)=A$  
- **德摩根律**  
  $A-(B\cup C)=(A-B)\cap (A-C)$  
  $A-(B\cap C)=(A-B)\cup (A-C)$  
  $\sim (B\cup C)=\sim B\cap \sim C$  
  $\sim (B\cap C)=\sim B\cup \sim C$  
  $\sim \empty=E$  
  $\sim E=\empty$  
- **双重否定律**  
  $\sim\sim A=A$  

- 取两个式子进行证明：  
  1  
  $x\in (A\cup (B\cap C))$  
  $\Leftrightarrow x\in A\lor x\in (B\cap C)$  
  $\Leftrightarrow x\in A\lor (x\in B\land x\in C)$  
  $\Leftrightarrow (x\in A\lor x\in B)\land (x\in A\lor x\in C)$  
  $\Leftrightarrow x\in ((A\cup B)\cap (A\cup C))$  
  2  
  $x\in (A-(B\cup C))$  
  $\Leftrightarrow x\in A\land (x\not\in B\cup C)$  
  $\Leftrightarrow x\in A\land \lnot (x\in B\cup C)$  
  $\Leftrightarrow x\in A\land \lnot (x\in B\lor x\in C)$  
  $\Leftrightarrow x\in A\land \lnot x\in B\land \lnot x\in C$  
  $\Leftrightarrow x\in A\land x\not\in B \land x\in A\land x\not\in C$  
  $\Leftrightarrow x\in (A-B)\cap(A-C)$  

## 7 二元关系

### 7.1 有序对与笛卡儿积

- **定义 7.1** 由两个元素 x 和 y（允许  $x=y$）按照一定顺序排列称的二元组称作一个**有序对**或**有序偶**，记作 $<x,y>$，其中 x 是它的第一元素，y 是它的第二元素。  
- 当 $x\ne y$ 时，$<x,y>\ne <y,x>$  。  
- $<x,y>=<u,v>$ 的充分必要条件是 $x=u$ 且 $y=v$ 。  
- **定义 7.2** 设 A，B 为集合，用 A 中元素为第一元素，B 中元素为第二元素构成有序对。所有这样的有序对组成的集合称作 A 和 B 的**笛卡儿积**，记作 $A\times B$ 。  
- $A\times B=\{<x,y>|x\in A \land y\in B\}$  
- 若 $|A|=m$ ，$|B|=n$ ，则 $|AB|=mn$ 。
- 空集的笛卡儿积一定是空集  
  $A\times\empty=\empty$ ，$\empty\times A=\empty$  
- 笛卡儿积一般不满足交换律（因为最终的结果是有序对）  
- 笛卡儿积一般不满足结合律（在第二次进行运算时是第一次运算产生的有序对作为元素参与运算，因此不满足结合律，如 $<<a,b>,c>$ 和 $<a,<b,c>>$）。  
- 笛卡儿积对并、交运算满足分配律  
  $A\times (B\cup C)=(A\times B)\cup (A\times C)$  
  $A\times (B\cap C)=(A\times B)\cap (A\times C)$  
  分配律的证明：  
  $<x,y>\in A\times (B\cup C)$  
  $\Leftrightarrow (x\in A)\land (y\in (B\cup C))$  
  $\Leftrightarrow (x\in A)\land ((y\in B)\cup (y\in C))$  
  $\Leftrightarrow (x\in A\land x\in B)\cup (x\in A\land x\in C)$  
  $\Leftrightarrow (A\times B)\cup (A\times C)$  
  理解：分配律只进行了一次笛卡儿积，因此不会出现结合律中出现的情况。  
- $A\subseteq C\land B\subseteq D\Rightarrow A\times B\subseteq C\times D$  
  证明：  
  对任意 $<u,v>\in A\times B$ ，有 $u\in A\land v\in B$ ，  
  而由 $A\subseteq C$ 及 $B\subseteq D$ ，可得 $\forall x(x\in A\rightarrow x\in C)$ ，$\forall x(x\in B\rightarrow x\in D)$ ，  
  故 $u\in C\land v\in B$ ，即 $<u,v>\in C\times D$ 。  
  这个命题是充分条件，不是必要条件。例如，取 $A=\empty$ ，则后件一定成立，但前件中的 $B\subseteq D$ 不一定成立。  

### 7.2 二元关系

- **定义 7.3** 如果一个集合满足以下条件之一：  
  （1）集合非空，且它的元素都是有序对；  
  （2）集合是空集；  
  则称该集合为一个**二元关系**，记作 R 。  
- 二元关系也可简称为**关系**。  
- 对于二元关系 R ，如果 $<x,y>\in R$ ，则记作 $xRy$ ，如果 $<x,y>\not\in R$ ，则记作 $x\bcancel{R}y$ 。  
- **定义 7.4** 设 A，B 为集合，$A\times B$ 的任何子集所定义的二元关系称作**从 A 到 B 的二元关系**，特别当 $A=B$ 时称作 **A 上的二元关系**。  
- 对于任何集合 A，空集 $\empty$ 是 $A\times A$ 的子集，称作 A 上的**空关系**。  
- **定义 7.5** 对任意集合 A ，定义  
  **全域关系** $E_A=\{<x,y>|x\in A\land y\in A\}=A\times A$  
  **恒等关系** $I_A=\{<x,x>|x\in A\}$  
- 常用的一些关系定义  
  **小于等于关系** $L_A=\{<x,y>|x,y\in A,x\le y\}$  
  **整除关系** $D_A=\{<x,y>|x,y \in A, x|y\}$，其中 x 是 y 的因子，A 是非零整数集 $\boldsymbol{Z}^*$ 的子集。  
  **包含关系** $R_{\subseteq}=\{<x,y>|x,y\in A, x\subseteq y\}$，A 是有一些集合构成的集合族。  
- 关系有三种表示方法：集合表达式、关系矩阵和关系图。  
  - **集合表达式**  
    例如，小于等于关系 $L_A=\{<x,y>|x,y\in A,x\le y\}$ 就是一种集合表达式的形式。  
  - **关系矩阵**  
    设 $A=\{x_1,x_2,...,x_n\}$ ，R 是 A 上的关系，令 $r_{ij}=\begin{cases}1, &若 x_iRx_j\\0, &若 x_i\bcancel Rx_j\end{cases}$ ，则 $\begin{pmatrix}r_{ij}\end{pmatrix}$ （矩阵） 是 R 的**关系矩阵**，记作 $\boldsymbol{M}_R$ 。
    例如，定义在 $A=\{1,2,3\}$ 上的小于等于关系的关系矩阵为 $\boldsymbol{M}_R=\begin{pmatrix}1 & 0 & 0\\1 & 1 & 0\\1 & 1 & 1\end{pmatrix}$ 。
  - **关系图**  
    设 $A=\{x_1,x_2,...,x_n\}$ ，R 是 A 上的关系，R 的**关系图**记作 $G_R$ 。$G_R$ 有 n 个顶点 $x_1,x_2,...,x_n$ ，如果 $<x_i,x_j>\in R$ ，在 $G_R$ 中就有一条从 $x_i$ 到 $x_j$ 的有向边。  

### 7.3 关系的运算

关系的基本运算有 7 种，分别是**定义域**、**值域**、**域**、**逆关系**、**右复合**、**限制**、**像**。  

- **定义 7.6** 设 R 是二元关系，  
  R 的所有有序对的第一元素构成的集合称为 R 的**定义域**，记作 $dom R$ （domain），  
  $domR=\{x|\exist y(<x,y>\in R)\}$  
  R 的所有有序对的第二元素构成的集合称为 R 的**值域**，记作 $ranR$ （range），  
  $ranR=\{y|\exist x(<x,y>\in R)\}$  
  R 的定义域和值域的并集称作 R 的**域**，记作 $fldR$ （field），  
  $fldR=domR\cup ranR$  
- **定义 7.7** 设 R 是二元关系，R 的**逆关系**，简称为 R 的逆，记作 $R^{-1}$ ，  
  $R^{-1}=\{<x,y>|<y,x>\in R\}$  
- **定义 7.8** 设 F，G 为二元关系，G 对 F 的**右复合**记作 $F\circ G$ ，  
  $F\circ G=\{<x,y>|\exist t(<x,t>\in F\land <t,y>\in G)\}$  
- **定义 7.9** 设 R 为二元关系，A 是集合，  
  （1）R 在 A 上的**限制**记作 $R\restriction A$ ，  
  $R\restriction A=\{<x,y>|xRy\land x\in A\}$  
  限制相当于找出关系 R 中第一元素在 A 中的有序对。  
  （2）A 在 R 下的**像**记作 $R[A]$ ，其中  
  $R[A]=ran(R\restriction A)$  
  像就是限制的值域。  

- **定理 7.1** 设 F 是任意的关系，则  
  （1）$(F^{-1})^{-1}=F$  
  （2）$dom F^{-1}=ran F, ran F^{-1}=dom F$  
  这两个定理很直观，因此逆关系就是交换了两个元素的顺序。  

$<x,y>\in (F^{-1})^{-1}$  
$\Leftrightarrow <y,x>\in F^{-1}$  
$\Leftrightarrow <x,y>\in  F$  

$x\in domF^{-1}$  
$\Leftrightarrow \exist y(<x,y>\in F^{-1})$  
$\Leftrightarrow \exist y(<y,x>\in F)$  
$\Leftrightarrow x\in ranF$  

- **定理 7.2** 设 F，G，H 是任意的关系，则  
  （1）$(F\circ G)\circ H=F\circ (G\circ H)$  
  （2）$(F\circ G)^{-1}=G^{-1}\circ H^{-1}$  
  右复合运算只与被运算元素的位置有关，因此加括号不影响结果。  

$<x,y>\in (F\circ G)\circ H$  
$\Leftrightarrow \exist t(<x,t>\in F\circ G \land <t,y>\in H)$  
$\Leftrightarrow \exist t(\exist s (<x,s>\in F\land <s,t>\in G)\land <t,y>\in G)$  
$\Leftrightarrow \exist t\exist s(<x,s>\in F \land <s,t>\in G \land <t,y>\in H)$  
$\Leftrightarrow \exist s(<x,s>\in F\land \exist t(<s,t>\in G\land <t,y>\in H))$  
$\Leftrightarrow \exist s(<x,s>\in F\land <s,y>\in G\circ H)$  
$<x,y>\in F\circ (G\circ H)$

$<x,y>\in (F\circ G)^{-1}$  
$\Leftrightarrow <y,x>\in F\circ G$  
$\Leftrightarrow \exist t(<y,t>\in F\land <t,x>\in G)$  
$\Leftrightarrow \exist t(<t,y>\in F^{-1}\land <x,t>\in G^{-1})$  
$\Leftrightarrow <x,y>\in G^{-1}\circ F^{-1}$  

- **定理 7.3** 设 R 为 A 上的关系，则  
  $R\circ I_A=I_A\circ R=R$  
  也即恒等关系对于右复合运算相当于数 1 。

$<x,y>\in R\circ I_A$  
$\Leftrightarrow \exist t(<x,t>\in R\land <t,y>\in I_A)$  
$\Leftrightarrow \exist t(<x,t>\in R\land t=y)$  
$\Leftrightarrow \exist y(<x,y>\in R)$  
$\Leftrightarrow <x,y>\in R$  
$\Leftrightarrow <x,y>\in R\land <x,x>\in I_A$  
$\Leftrightarrow \exist x(<x,x>\in I_A\land <x,y>\in R)$  
$\Leftrightarrow <x,y>\in I_A\circ R$

- **定理 7.4** 设 F，G，H 为任意关系，则  
  （1）$F\circ (G\cup H)=F\circ G\cup F\circ H$  
  （2）$F\circ (G\cap H)\subseteq F\circ G\cap F\circ H$  
  **注意后者是包含关系**。  

$<x,y>\in F\circ(G\cup H)$  
$\Leftrightarrow \exist t(<x,t>\in F\land <t,y>\in (G\cup H))$  
$\Leftrightarrow \exist t(<x,t>\in F\land (<t,y>\in G\lor <t,y>\in H))$  
$\Leftrightarrow \exist t((<x,t>\in F\land <t,y>\in G)\lor (<x,t>\in F\land <t,y>\in H))$  
$\Leftrightarrow \exist t(<x,t>\in F\land <t,y>\in G)\lor \exist t(<x,t>\in F\land <t,y>\in H)$  
$\Leftrightarrow <x,y>\in F\circ G \lor <x,y>\in F\circ H$  
$\Leftrightarrow <x,y>\in F\circ G\cup F\circ G$  

考虑 $\exist x(A(x)\land B(x))\Rightarrow \exist x(A(x))\land \exist x(B(x))$  
即可得到右复合对交运算的包含关系。  

- **定理 7.5** 设 F 为关系，A，B 为集合，则  
  （1）$F\restriction (A\cup B)=F\restriction A\cup F\restriction B$  
  （2）$F[A\cup B]=F[A]\cup F[B]$  
  （3）$F\restriction (A\cap B)=F\restriction A\cap F\restriction B$  
  （4）$F[A\cap B]\subseteq F[A]\cap F[B]$  
  **注意像对集合的交运算是包含关系**。  

$<x,y>\in F\restriction (A\cap B)$  
$\Leftrightarrow xFy\land x\in (A\cap B)$  
$\Leftrightarrow xFy\land x\in A\land x\in B$  
$\Leftrightarrow <x,y>\in F\restriction A\land <x,y>\in F\restriction B$  
$\Leftrightarrow <x,y>\in F\restriction A\cap F\restriction B$

$x\in F[A\cap B]$  
$\Leftrightarrow \exist y(y\in A\cap B\land yFx)$  
$\Leftrightarrow \exist y(y\in A\land y\in B\land yFx)$  
$\Rightarrow \exist y((y\in A\land yFx)\land (y\in B\land yFx))$  
$\Leftrightarrow y\in F[A]\land y\in F[B]$  
$\Leftrightarrow y\in F[A]\cap F[B]$  

- **定义 7.10** 设 R 为 A 上的关系，n 为自然数，则 R 的 **n 次幂** $R^n$ 定义为  
  （1）$R^0=\{<x,x>|x\in A\}=I_A$  
  （2）$R^{n+1}=R^n\circ R$  

考虑右复合运算，如果将关系写成矩阵的形式，则**幂的计算类似矩阵的计算，只需要将相加改为逻辑相加即可**。  

- **定理 7.6** 设 A 为 n 元集，R 是 A 上的关系，则存在自然数 s 和 t ，使得 $R^s=R^t$ 。  

证：由于 R 是 A 上的关系，即 R 一定是 $A\times A$ 的一个子集，对任意自然数 k，$R^k$ 也一定是 $A\times A$ 的子集，而 $|2^{A\times A}|=2^{n^2}$ ，也即 $A\times A$ 的子集是一个有限集，即得证。  

- **定理 7.7** 设 R 为 A 上的关系，$m,n \in \boldsymbol{N}$ ，则  
  （1）$R^m\circ R^n=R^{m+n}$  
  （2）$(R^m)^n=R^{mn}$

证：  
$R^m\circ R^0=R^m$ ，  
假设 $R^m\circ R^n=R^{m+n}$ ，则  
$R^m\circ R^{n+1}=R^m\circ (R^n\circ R)$ （根据定义）  
$=R^m\circ R^n \circ R$ （根据右复合的运算性质）  
$=R^{m+n}\circ R$ （根据假设）  
$=R^{m+n+1}$ （根据定义）  
归纳得证。  

$(R^m)^0=R^0$ ，  
假设 $(R^m)^n=R^{mn}$ ，则  
$(R^m)^{n+1}=(R^m)^n\circ R^m$  
$=R^{mn}\circ R^m$ （根据假设）  
$=R^{m(n+1)}$ （根据第一个性质）  
归纳得证。  

- **定理 7.8** 设 R 为 A 上的关系，若存在自然数 $s,t(s<t)$ 使得 $R^s=R^t$ ，则  
  （1）对任何 $k\in \boldsymbol{N}$ 有 $R^{s+k}=R^{t+k}$ ；  
  （2）对任何 $k,i\in \boldsymbol{N}$ 有 $R^{s+kp+i}=R^{s+i}$ ，其中 $p=t-s$ ；  
  （3）令 $S=\{R^0,R^1,...,R^{t-1}\}$ ，则对于任意的 $q\in \boldsymbol{N}$ 有 $R^q\in S$ ；  

证：  
$R^{s+k}=R^s\circ R^k=R^t\circ R^k=R^{t+k}$  
这个定理说明，如果找到了两个相等的值，则平移之后得到的两个值也一定相等。

当 $k=0$ 时，显然成立；  
假设为 k 时成立，即 $R^{s+kp+i}=R^{s+i}$ ，  
此时 $R^{s+(k+1)p+i}=R^{s+kp+i+p}$  
$=R^{s+kp+i}\circ R^{p}$ （定理 7.7）  
$=R^{s+i}\circ R^p$ （根据假设）  
$=R^{s+i+p}=R^{s+i+t-s}=R^{i+t}$  
$=R^{i}\circ R^{t}=R^{i}\circ R^{s}=R^{s+i}$ ，归纳得证。  
这个定理说明，如果找到了两个相等的值，则按照这两个值的宽度进行平移或者整数倍扩大，得到的两个值也是相等的（结合函数图像理解），也即具有周期性。  

当 $q<t$ 时，显然成立。  
当 $q\ge t$ 时，取 $p=t-s$ ，则一定存在 $k,i\in \boldsymbol{N},i<p$ ，使得 $s+kp+i=q$ （因为 p 是正整数，$kp+i$ 覆盖了整个自然数集）。  
则 $R^q=R^{s+kp+i}=R^{s+i}$ ，而 $s+i<s+p=t$ ，也即 $R^{s+i}\in S$ ，即得证。  
这个定理在周期性的基础上给出了集合的关系。  

### 7.4 关系的性质

- **定义 7.11** 设 R 为 A 上的关系，  
  （1）若 $\forall x(x\in A\rightarrow <x,x>\in R)$ ，则称 R 在 A 上是**自反**的。  
  （2）若 $\forall x(x\in A\rightarrow <x,x>\not\in R)$ ，则称 R 在 A 上是**反自反**的。  
  R 为 A 上的自反关系当且仅当 R 包含 A 上的恒等关系，即 $I_A\subseteq R$。  
  R 为 A 上的反自反关系当且仅当 R 和 A 上的恒等关系没有交集，即 $R\cap I_A=\empty$。  
  自反关系和反自反关系是互斥的。  

**例** 设 $A=\{1,2,3\}$ ，$R_1,R_2$ 和 $R_3$ 是 A 上的关系，其中  
$R_1=\{<1,1>,<2,2>\}$  
$R_2=\{<1,1>,<2,2>,<3,3>,<1,3>\}$  
$R_3=\{<1,3>\}$  
则 $R_1$ 既不是 A 上的自反关系，也不是反自反关系。$R_2$ 是 A 上的自反关系。$R_3$ 是 A 上的反自反关系。  

- **定义 7.12** 设 R 为 A 上的关系，  
  （1）若 $\forall x\forall y (x,y\in A\land <x,y>\in R\rightarrow <y,x>\in R)$ ，则称 R 为 A 上**对称**的关系。  
  （2）若 $\forall x\forall y(x,y\in A\land <x,y>\in R\land <y,x>\in R\rightarrow x=y)$ ，则称 R 为 A 上的**反对称**的关系。  
  R 为 A 上的对称关系当且仅当 R 中的所有有序对交换次序后仍然是 A 中的元素，即 $R^{-1}=R$。  
  R 为 A 上的反对称关系当且仅当 R 中的所有对称的有序对都是第一元素和第二元素相等的有序对，即 $R^{-1}\cap R\subseteq I_A$。  
  对称关系和反对称关系不是互斥的（如 $\{<1,1>,<2,2>\}$ 既是对称关系又是反对称关系）。  

- **定义 7.13** 设 R 为 A 上的关系，若  
  $\forall x\forall y\forall z(x,y,z\in A\land <x,y>\in R\land <y,z>\in R\rightarrow <x,z>\in R)$  
  则称 R 为 A 上**传递**的关系。  
  R 为 A 上的传递的关系，当且仅当 $R\circ R \subseteq R$ 。

- **定理 7.9** 略，已在定义中给出。

### 7.5 关系的闭包

通过添加尽可能少的有序对来使某个关系达到某个性质，得到的新的关系就是闭包。如**自反闭包**、**对称闭包**、**传递闭包**。  

- **定义 7.14** 设 R 是非空集合 A 上的关系，R 的自反（对称或传递）闭包是 A 上的关系 $R'$ ，使得 $R'$ 满足以下条件：  
  （1）$R'$ 是自反的（对称的、传递的）；  
  （2）$R\subseteq R'$ ；  
  （3）对 A 上任何包含 R 的自反（对称、传递）关系 $R''$ 有 $R'\subseteq R''$ ；  

- 分别记 R 的自反、对称、传递闭包为 $r(R), s(R), t(R)$ 。

自反的：reflexive  
对称的：symmetrical  
传递的：transitive  

- **定理 7.10** 设 R 为 A 上的关系，则有  
  （1）$r(R)=R\cup R^0$  
  （2）$s(R)=R\cup R^{-1}$  
  （3）$t(R)=R\cup R^2\cup R^3\cup ...$

证（1）：  
由于 $R^0=I_A$ ，故 $R\cup R^0$ 是自反的；  
$R\subseteq R\cup R^0$ 显然成立；  
再设 $R''$ 是包含 $R$ 的一个自反关系，也即 $I_A\subseteq R'',R\subseteq R''$ ，  
$<x,y>\in R\cup R^0$  
$\Leftrightarrow <x,y>\in R\cup I_A$  
$\Rightarrow <x,y>\in R''\cup R''$  
$\Leftrightarrow <x,y>\in R''$  
也即 $R\cup R^0\subseteq R''$ ，故得证。  

证（2）：  
$<x,y>\in R\cup R^{-1}$  
$\Leftrightarrow <x,y>\in R\lor <x,y>\in R^{-1}$  
$\Leftrightarrow <y,x>\in R^{-1}\lor <y,x>\in R$  
$\Leftrightarrow <y,x>\in R\cup R^{-1}$  
即 $R\cup R^{-1}$ 是对称的。  
$R\subseteq R\cup R^{-1}$ 显然成立。  
再设 $R''$ 是一个包含 $R$ 的对称的关系，即 $R\subseteq R'',R''^{-1}=R''$ ，  
$<y,x>\in R^{-1}$  
$\Leftrightarrow <x,y>\in R$  
$\Rightarrow <x,y>\in R''$  
$\Leftrightarrow <y,x>\in R''^{-1}$  
即 $R^{-1}\subseteq R''^{-1}$ ，  
即同样有 $R\cup R^{-1}\subseteq R''\cup R''^{-1}$ 。故得证。  

证（3）：  
$<x,y>\in R\cup R^2\cup R^3\cup ...\land <y,z>\in R\cup R^2\cup R^3 \cup ...$  
$\Rightarrow \exist m\exist n(<x,y>\in R^m\land <y,z>\in R^n)$  
$\Rightarrow \exist m\exist n(<x,z>\in R^m\circ R^n)$  
$\Rightarrow \exist m\exist n(<x,z>\in R^{m+n})$  
$\Rightarrow <x,z>\in R\cup R^2\cup R^3\cup ...$  
即 $R\cup R^2\cup R^3\cup ...$ 是传递的关系。  
$R\subseteq R\cup R^2\cup R^3 \cup ...$ 显然成立。  
假设 $R''$ 为一个包含 $R$ 的传递的关系，即 $R\subseteq R'',R''\circ R''\subseteq R''$ ，  
现用归纳法证明 $R\cup R^2\cup R^3\cup  ...\subseteq R''$ ，不妨证明 $R^n\subseteq R''$ ，  
当 $n=1$ 时，$R\subseteq R''$ 成立，  
$n=k$ 时，假设 $R^k\subseteq R''$ 成立，  
当 $n=k+1$ 时，  
$<x,y>\in R^{k+1}$  
$\Leftrightarrow <x,y>\in R^k\circ R$  
$\Leftrightarrow \exist t(<x,t>\in R^k\land <t,y>\in R)$  
$\Rightarrow \exist t(<x,t>\in R''\land <t,y>\in R'')$  
$\Rightarrow <x,y>\in R''\circ R''$  
$\Rightarrow <x,y>\in R''$ ，  
也即归纳得证。  

- **推论** 设 R 为有穷集 A 上的关系，则存在正整数 r 使得  
  $t(R)=R\cup R^2\cup R^3\cup ... \cup R^r$  
  证明：由 $ A\times A$ 是一个有限集可以证得。  

- 闭包在**矩阵形式**上的性质：  
  设关系 $R,r(R),s(R),t(R)$ 的关系矩阵分别为 $\boldsymbol{M},\boldsymbol{M}_r,\boldsymbol{M}_s,\boldsymbol{M}_t$ ，则  
  $\boldsymbol{M}_r=\boldsymbol{M}+\boldsymbol{E}$  
  $\boldsymbol{M}_s=\boldsymbol{M}+\boldsymbol{M}^r$  
  $\boldsymbol{M}_t=\boldsymbol{M}+\boldsymbol{M}^2+\boldsymbol{M}^3 +...$  
  其中， $\boldsymbol{M}^r$ 为转置矩阵，加法为逻辑加。  

- 闭包在**关系图形式**上的性质：  
  对所有顶点，如果没有环就加上环，就得到自反闭包。  
  对所有路径，如果没有对称的路径，就加上对称的路径，就得到对称闭包。  
  对所有路径，如果相连的两个路径之间没有同向路径，就加上同向路径，就得到传递闭包。  

- **定理 7.11** 设 R 是非空集合 A 上的关系，则  
  （1）R 是自反的当且仅当 $r(R)=R$ ；  
  （2）R 是对称的当且仅当 $s(R)=R$ ；  
  （3）R 是传递的当且仅当 $t(R)=R$ ；  

三者的充分性都是显然的，这里只证必要性。  
证（1）：  
$r(R)=R\cup R^0$ ，  
由于 $R$ 是自反的，取 $R'=R$ ，则 $R'$ 是一个包含了 $R$ 的自反关系，  
因此有 $r(R)\subseteq R'$ ，也即 $r(R)\subseteq R$ ，  
同时 $R\subseteq R\cup R^0$ ，也即 $R\subseteq r(R)$ ，  
故 $R=r(R)$ 。  

（2）（3）证明类似。  

- **定理 7.12** 设 $R_1$ 和 $R_2$ 是非空集合 A 上的关系，且 $R_1\subseteq R_2$ ，则  
  （1）$r(R_1)\subseteq r(R_2)$  
  （2）$s(R_1)\subseteq s(R_2)$  
  （3）$t(R_1)\subseteq t(R_2)$  

证（1）：  
