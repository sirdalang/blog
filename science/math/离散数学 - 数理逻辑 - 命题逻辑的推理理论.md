# 离散数学

## 3 命题逻辑的推理理论

### 3.1 推理的形式结构

- **推理**是指从前提出发推出结论的思维过程，**前提**是已知的命题公式集合，**结论**是从前提出发应用推理规则推出的命题公式。

- **定义 3.1**  
  设 $A_1,A_2,...,A_k$ 和 $B$ 都是命题公式，若对于 $A_1,A_2,...,A_k$ 和 $B$ 中出现的命题变项的任意一组赋值，或者 $A_1\land A_2\land ...\land A_k$ 为假，或者当 $A_1\land A_2 \land ... \land A_k$ 为真时 $B$ 也为真，则称由前提 $A_1,A_2,...,A_k$ 推出结论 $B$ 的推理是**有效的**或**正确的**，并称 $B$ 为**有效的结论**。

> 推理错误当且仅当 $A_1\land A_2\land ... \land A_n$ 为假，$B$ 为真。  
> 对于一个正确的推理，如果前提正确，则结论一定正确，如果前提错误，则结论可能正确，也可能错误。  
> 推理的定义是命题公式的集合之间的关系。

- 设前提为集合 $\Gamma$ ，将由 $\Gamma$ 推出 $B$ 的推理记为 $\Gamma \vdash B$ 。若推理是正确的，则记为 $\Gamma \vDash B$ ，否则记为 $\Gamma \nvDash B$ 。这里称 $\Gamma \vdash B$ 或 $\{A_1,A_2,...,A_k\}\vdash B$ 为**推理的形式结构**。

- **定理 3.1**  
  命题公式 $A_1,A_2,...,A_k$ 推出 $B$ 的推理正确当且仅当 $A_1\land A_2\land ... \land A_k\to B$ 为重言式。

> 充分性。$A_1\land A_2\land ... \land A_k\to B$ 为重言式，则对任意赋值，该式为真，即不会出现前真后假的情况，因此符合推理正确的定义。  
> 必要性。若推理正确，则必没有前真后假的情况，因此也即对任意赋值，相应的蕴含式必为真，也即蕴含式为永真式。

- 根据定理 3.1 ，也即 $\{A_1,A_2,...,A_k\}\vDash B$ 等价于 $A_1\land A_2\land ... \land A_k \Rightarrow B$ ，这里 $\Rightarrow$ 为元语言符号，表示蕴含式为重言式。

> 判断推理是否正确，也即判断对应的蕴含式是否为永真式，相应有真值表法、等值演算法、主析取范式法。

> **例**  
> 判断下面的推理是否正确。  
> （1）下午马芳或去看电影或去游泳，她没去看电影，所以，她去游泳了。  
> 分析：  
> 定义命题：  
> $p$：下午马芳去看电影；  
> $q$：下午马芳去游泳；  
> 将推理符号化，为  
> 前提：$((p\land \lnot q)\lor (\lnot p\land q))\land \lnot p$  
> 结论：$q$  
> 推理的形式结构为  
> $E=(((p\land \lnot q)\lor (\lnot p\land q))\land \lnot p)\to q$  
> 判断该式是否为重言式，可以用等值演算法，即  
> $E\Leftrightarrow (\lnot p\land q)\to q$ $\Leftrightarrow$  
> $\lnot (\lnot p\land q)\lor q$ $\Leftrightarrow$  
> $p\lor \lnot q\lor q$ $\Leftrightarrow$  
> $1$
> 也即推理正确。
>
> （2）若下午气温超过 $30$ 摄氏度，则王小燕必去游泳，若她去游泳，她就不去看电影了。所以，若王小燕没去看电影，下午气温必超过了 $30$ 摄氏度。  
> 分析：定义命题：  
> $p$：下午气温超过 30 摄氏度；  
> $q$：王小燕去游泳；  
> $r$：王小燕去看电影；  
> 推理符号化为：  
> 前提：$(p\to q)\land (q \to \lnot r)$  
> 结论：$(\lnot r\to p)$  
> 推理的形式化结构为  
> $E=((p\to q)\land (q \to \lnot r))\to (\lnot r\to p)$  
> 使用等值演算，即  
> $E\Leftrightarrow $  
> $((\lnot p\lor q)\land (\lnot q \lor \lnot r))\to (r\lor p)$ $\Leftrightarrow$  
> $\lnot ((\lnot p\lor q)\land (\lnot q \lor \lnot r))\lor (r\lor p)$ $\Leftrightarrow$  
> $(\lnot (\lnot p\lor q)\lor \lnot (\lnot q\lor \lnot r))\lor (r\lor p)$ $\Leftrightarrow$  
> $((p\land \lnot q)\lor (q\land r))\lor (r\lor p)$ $\Leftrightarrow$  
> $(p\land \lnot q)\lor (q\land r)\lor r\lor p$ $\Leftrightarrow$  
> $p\lor r$  
> 此时，已经可以判断不是重言式（$p=0\land r=0$）。

> **推理定律**  
>
> 序号 | 推理定律 | 名字
> :-: | :- | :-
> 1 | $A\Rightarrow (A\lor B)$ | 附加律
> 2 | $(A\land B)\Rightarrow A$ | 化简律
> 3 | $(A\to B)\land A\Rightarrow B$ | 假言推理
> 4 | $(A\to B)\land \lnot B\Rightarrow \lnot A$ | 拒取式
> 5 | $(A\lor B)\land \lnot B\Rightarrow A$ | 析取三段论
> 6 | $(A\to B)\land (B\to C)\Rightarrow A\to C$ | 假言三段论
> 7 | $(A\Leftrightarrow B)\land (B\Leftrightarrow C)\Rightarrow A\Leftrightarrow C$ | 等价三段论
> 8 | $(A\to B)\land (C\to D)\land (A\lor C)\Rightarrow (B\lor D)$ | 构造性二难
> 8.1 | $(A\to B)\land (\lnot A\to B)\Rightarrow B$ | 构造性二难（特殊形式）
> 9 | $(A\to B)\land (C\to D)\land (\lnot B\lor \lnot D)\Rightarrow (\lnot A\lor \lnot C)$ | 破坏性二难

> **证明示例**：
>
> 对 $(A\lor B)\land \lnot B\Rightarrow A$ ，替换为 $(p\lor q)\land \lnot q\to p$ 永真，  
> 记为 $E\Leftrightarrow$  
> $\lnot ((p\lor q)\land \lnot q)\lor p$ $\Leftrightarrow$  
> $(\lnot p\land \lnot q)\lor q\lor p$ $\Leftrightarrow$  
> $(\lnot p\lor q)\lor p$ $\Leftrightarrow$  
> $1$  
> 即永真成立。

### 3.2 自然推理系统 $P$

- **证明**是一个描述推理过程的命题公式序列，其中的每个公式或者是已知前提，或者是由前面的公式应用推理规则得到的结论（中间结论或推理中的结论）。

- **定理 3.2**  
  一个形式系统 $I$ 由下面 $4$ 个部分组成。  
  （1）非空的**字母表** $A(I)$ 。  
  （2）$A(I)$ 中符号构造的**合式公式集** $E(I)$ 。  
  （3）$E(I)$ 中一些特殊的公式组成的**公理集** $A_X(I)$ 。  
  （4）**推理规则集** $R(I)$ 。  
  将 $I$ 记为 $4$ 元组 $<A(I),E(I),A_X(I),R(I)>$ 。其中 $<A(I),E(I)>$ 是 $I$ 的**形式语言系统**，而 $<A_X(I),R(I)>$ 为 $I$ 的**形式演算系统**。

- 形式系统一般分为两类，分别是**自然推理系统**和**公理推理系统**。自然推理系统的特点是从任意给定的前提出发，应用系统中的推理规则进行推理演算，最后得到的命题公式是推理的结论（不一定是重言式）。公理推理系统的特点是只能从若干给定的公理出发，应用系统中的推理规则进行推理演算，得到的结论是系统中的重言式，称为系统中的**定理**。

- **定理 3.3**  
  自然推理系统 $P$ 的定义如下：  
  1. 字母表  
  （1）命题变项符号：$p,q,r,...,p_i,q_i,r_i,...$  
  （2）联结词符号：$\lnot ,\land,\lor,\to,\leftrightarrow$  
  （3）括号与逗号：$) ( ,$  
  2. 合式公式  
  参考定义 1.6 （单个命题变项以及有限次联结）。  
  3. 推理规则  
  （1）前提引入规则：在证明的任何步骤都可以引入前提；  
  （2）结论引入规则：在证明的任何步骤所得到的结论都可以作为后继证明的前提；  
  （3）置换规则：在证明的任何步骤，命题公式中的子公式都可以用等值的公式置换，得到公式序列中的又一个公式；  
  （4）根据 9 条推理定律以及结论引入规则，可以相应导出 9 条推理规则。  

- 设前提 $A_1,A_2,...,A_k$ ，结论 $B$ 和公式序列 $C_1,C_2,...,C_l$ ，如果每一个 $i$ ，$C_i$ 是某个 $A_j$ ，或者可由序列中前面的公式应用推理规则得到，并且 $C_l=B$ ，则称公式序列 $C_1,C_2,...,C_l$ 是由 $A_1,A_2,...,A_k$ 推出 $B$ 的一个**证明**。

> **附加前提证明法**  
> $(A_1\land A_2\land ...\land A_k)\to (A\to B)$ $\Leftrightarrow$  
> $(A_1\land A_2\land ...\land A_k\land A)\to B$  
> 也即如果结论是蕴含式，则可以将结论中的蕴含式的前件也作为推理的前提。  
> 证明：  
> $(A_1\land A_2\land ...\land A_k)\to (A\to B)$ $\Leftrightarrow$  
> $\lnot (A_1\land A_2\land ...\land A_k)\lor (\lnot A\lor B)$ $\Leftrightarrow$  
> $(A_1\land A_2\land ...\land A_k\land A)\to B$  

> **归谬法**  
> $(A_1\land A_2\land ... \land A_k)\to B$ $\Leftrightarrow$  
> $(A_1\land A_2\land ...\land A_k\land \lnot B)$ 为矛盾式。  
> 也即如果将结论的反面作为前提进行推理能得到矛盾式，则推理正确。  
> 证明：  
> $(A_1\land A_2\land ... \land A_k)\to B$ $\Leftrightarrow$  
> $\lnot (A_1\land A_2\land ... \land A_k)\lor B$ $\Leftrightarrow$  
> $\lnot (A_1\land A_2\land ... \land A_k \land \lnot B)$  
> 如果 $\lnot (A_1\land A_2\land ... \land A_k \land \lnot B)$ 为矛盾式，则原式为永真式。  

### 3.3 消解证明法

- **消解证明法**：  
  根据归谬法，将结论的反面和前提化为合取范式，然后通过消解规则，如果消解出空，则为矛盾式，相应的推理就得到证明。
