# 高等数学 - 微分方程

微分方程部分设计一些模式化的技巧，特列于此供查阅。

[toc]

## 1 微分方程

- 一般地，凡表示未知函数、未知函数的倒数与自变量之间的关系的方程，叫做**微分方程**。
- 找出这样的函数，把这个函数代入微分方程能使该方程成为恒等式，这个函数就叫做该**微分方程的解**。
- 如果微分方程的解中含有任意常数（线性无关），且任意常数的个数与微分方程的阶数相同，这样的解叫做**微分方程的通解**。
- 由于通解中含有任意常数，所以它还不能完全确定地反映某一客观事物的规律性，要完全确定地反映客观事物的规律性，必须确定这些常数的值。为此，要根据问题的实际情况，提出确定这些常数的条件，这种条件叫做**初值条件**。
- 确定了微分方程中的任意常数之后，就得到了微分方程的**特解**。
- 求微分方程 $y'=f(x,y)$ 满足初值条件 $y|_{x=x_0}=y_0$ 的特解这样一个问题，叫做一阶微分方程的**初值问题**。记作：$\begin{cases}
y'=f(x,y) \\
y|_{x=x_0}=y_0
\end{cases}$ 。
- 微分方程的解的图形是一条曲线，叫做**微分方程的积分曲线**。初值问题的**几何意义**就是求微分方程的通过点 $(x_0,y_0)$ 的那条积分曲线。二阶微分方程的初值问题 $\begin{cases}
y''=f(x,y,y') \\
y|_{x=x_0}=y_0;y'|_{x=x_0}=y_0'
\end{cases}$ 的几何意义是求微分方程的通过点 $(x_0,y_0)$ 且在该点处的切线斜率为 $y_0'$ 的那条积分曲线。

## 2 可分离变量的微分方程

- 一般地，如果一个一阶微分方程能写成 $g(y)\text{d}y=f(x)\text{d}x$ 的形式，也即能写成一端只含 $y$ 的函数和 $\text{d}y$ ，另一端只含 $x$ 的函数和 $\text{d}x$ ，那么原方程就称为**可分离变量的微分方程**。

- 通用解法：

> 设 $y=\varphi(x)$ 为 $g(y)\text{d}y=f(x)\text{d}x$ 的解，则有 $g(\varphi(x))\text{d}\varphi(x)=f(x)\text{d}x$ ，
即 $g(y)y'\text{d}x=f(x)\text{d}x$ ，
积分得 $\int g(y)\text{d}y=\int f(x)\text{d}x$ ，
设 $g(y)$ 和 $f(x)$ 分别有原函数 $G(y)$ 和 $F(x)$ ，
则 $G(y)=F(x)+C$ 。

- 例1：

> 求微分方程 $\frac{\text{d}x}{\text{d}y}=2xy$ ，求通解。
> 解：$\frac{\text{d}x}{x}=2y\text{d}y$ ，即 $ln|x|=y^2+C$

## 3 齐次方程

- 如果一阶微分方程可以化为 $\frac{\text{d}y}{\text{d}x}=\varphi(\frac{y}{x})$ 的形式，则称这个方程为齐次方程。

- 通用解法：

> 引进 $u=\frac{y}{x}$ ，即 $y=ux$ ，$\frac{\text{d}y}{\text{d}x}=u+x\frac{\text{d}u}{\text{d}x}$ ，即微分方程化为 $u+x\frac{\text{d}u}{\text{d}x}=\varphi(u)$ ，于是就变成了可分离变量的微分方程形式。$\frac{\text{d}u}{\varphi(u)-u}=\frac{\text{d}x}{x}$ ，积分后再将 $u$ 替换，即得通解。

## 4 可化为齐次的方程

- 方程 $\frac{\text{d}y}{\text{d}x}=\frac{ax+by+c}{a_1x+b_1y+c_1}$ ，当 $c\ne c_1$ 时不是齐次的，可以通过变换将其转换成齐次的。

- 通用解法：

> 令 $x=X+h,y=Y+k$ ，从而方程为 $\frac{\text{d}y}{\text{d}x}=\frac{aX+bY+ah+bk+c}{a_1X+b_1Y+a_1h+b_1k+c_1}$ ，解线性方程组 $\begin{cases}
ah+bk+c=0 \\
a_1h+b_1k+c_1=0
\end{cases}$ ，若有解，即可化为齐次方程。

## 5 一阶线性微分方程

- 方程 $\frac{\text{d}y}{\text{d}x}+P(x)y=Q(x)$ 叫做一阶线性微分方程。当 $Q(x)\equiv0$ ，为齐次的，否则为非齐次的。
- 通用解法：
 
> 求一阶线性微分方程时，先求对应的齐次方程的通解，然后将通解中的常数变易为 $u(x)$ ，代入原来的非齐次形式的方程，求 $u(x)$ 。

- 例1：
> 求方程 $\frac{\text{d}y}{\text{d}x}-\frac{2y}{x+1}=(x+1)^{\frac{5}{2}}$ 的通解.
> 解：这是一个一阶线性非齐次微分方程，齐次形式为 $\frac{\text{d}y}{\text{d}x}-\frac{2y}{x+1}=0$ ，即 $\frac{\text{d}y}{y}=\frac{2\text{d}x}{x+1}$ ，按可分离变量的方程求法，可得 $ln|y|=2ln|x+1|+C_1$ ,即 $y=C(x+1)^2$ 。将常数变易为 $u(x)$ ，即有 $y=u(x)(x+1)^2$ ，则有 $\frac{\text{d}y}{\text{d}x}=u'(x+1)^2+2u(x+1)$ ，代入原非齐次方程得 $u'(x+1)^2+2u(x+1)-2u(x+1)=(x+1)^{\frac{5}{2}}$ ，即 $u'=(x+1)^{\frac{1}{2}}$ ，得 $u(x)=\frac{2}{3}(x+1)^{\frac{3}{2}}+C_2$ ，即有原方程得通解为 $y=(\frac{2}{3}(x+1)^{\frac{3}{2}}+C_2)(x+1)^2$ 。

## 6 伯努利方程

- 方程 $\frac{\text{d}y}{\text{d}x}+P(x)y=Q(x)y^n,y\ne 0,1$ 称为伯努利方程。
- 通用解法：

> $\implies \frac{\text{d}y}{\text{d}x}y^{-n}+P(x)y^{1-n}=Q(x)$ ，取 $u(y)=y^{1-n}$ ，则有 $\frac{\text{d}u}{\text{d}x}=(1-n)y^{-n}\frac{\text{d}y}{\text{d}x}$ ，原方程 $\implies \frac{1}{1-n}\frac{\text{d}u}{\text{d}x}+P(x)u(y)=Q(x)$ ，得到了一个线性方程。

- 例1：

> 略

## 7 可降阶的高阶微分方程

### 7.1 $y^{(n)}=f(x)$

- 通用解法：

> 多次积分即可得到结果。

### 7.2 $y''=f(x,y')$

- 方程不含 $y$ ，因此可以替换 $p=y'$ ，此时有 $y''=\frac{\text{d}p}{\text{d}x}=p'$ ，原式化为 $p'=f(x,p)$ 。

- 例1：

> 求微分方程 $(1+x^2)y''=2xy'$ 满足初值条件 $y|_{x=0}=1,y'|_{x=0}=3$ 的特解。
> 解：取 $p=y'$ ，有 $(1+x^2)\frac{\text{d}p}{\text{d}x}=2xp$ ，可分离变量为 $\frac{\text{d}p}{p}=\frac{2x}{1+x^2}\text{d}x$ ，即 $ln|p|=ln(1+x^2)+C_1$ ，即 $p=C_2(1+x^2)$ ，即 $\frac{\text{d}y}{\text{d}x}=C(1+x^2)$ ，代入条件 $y'|_{x=0}=3$ ，可得 $C=3$ ，故 $\frac{\text{d}y}{\text{d}x}=3x^2+3$ ，积分可得 $y=x^3+3x+C$ ，再代入条件 $y|_{x=0}=1$ ，得 $y=x^3+3x+1$ 。

### 7.3 $y''=f(y,y')$

- 方程中不含 $x$ ，同样替换 $p=y'$ ，利用复合函数求导 $y''=\frac{\text{d}p}{\text{d}x}=\frac{\text{d}p}{\text{d}y}\frac{\text{d}y}{\text{d}x}=p\frac{\text{d}p}{\text{d}y}$ ，原式化为 $p\frac{\text{d}p}{\text{d}y}=f(y,p)$ ，就得到一个关于 $p,y$ 的一阶微分方程。

- 例1：

> 求微分方程 $yy''-y'^2=0$ 的通解。
> 解：取 $p=y'$ ，有 $y''=\frac{\text{d}p}{\text{d}y}y'$ ，代入得 $y\frac{\text{d}p}{\text{d}y}y'-y'^2=0$ ，即 $y\frac{\text{d}p}{\text{d}y}p-p^2=0$ ，仅考虑 $y\ne 0,p\ne 0$ ，得 $\frac{\text{d}p}{p}=\frac{\text{d}y}{y}$ ，$ln|p|=ln|y|+C_1$ ，即 $p=Cy$ ，$y'=Cy$ ，故 $\frac{\text{d}y}{\text{d}x}=Cy$ ，有 $ln|y|=Cx+C_1$ ，即 $y=C_1e^{C_2x}$ 。

## 8 高阶线性微分方程

对于二阶齐次线性方程 $y''+P(x)y'+Q(x)y=0$

- 如果 $y_1(x)$ 和 $y_2(x)$ 是方程的两个解，那么其线性组合也是方程的解。
- 如果 $y_1(x)$ 和 $y_2(x)$ 是方程的两个解，且线性无关，则 $y=y_1(x)+y_2(x)$ 是方程的通解。
- 如果 $y_1(x),y_2(x),...,y_n(x)$ 是方程 $y^{(n)}+a_1(x)y^{(n-1)}+...+a_{n-1}(x)y'+a_n(x)y=0$ 的 $n$ 个线性无关的解，那么这个方程的通解为 $y=C_1y_1(x)+C_2y_2(x)+...+C_ny_n(x)$。
- 设 $y^*(x)$ 是二阶非齐次线性方程 $y''+P(x)y'+Q(x)y=f(x)$ 的一个特解，$Y(x)$ 对应的齐次方程的一个通解，则 $y=Y(x)+y^*(x)$ 是二阶非齐次线性微分方程的通解。
- （**叠加原理**）设非齐次线性方程的右端 $f(x)$ 是两个函数之和，即 $y''+P(x)y'+Q(x)y=f_1(x)+f_2(x)$ ，而 $y^*_1(x)$ 和 $y_2^*(x)$ 分别是方程 $y''+P(x)y'+Q(x)y=f_1(x)$ 和 $y''+P(x)y'+Q(x)y=f_2(x)$ 的特解，则 $y^*_1(x)+y_2^*(x)$ 就是原方程的通解。

## 9 常系数齐次线性微分方程

- $y''+py'+qy=0$ ，其中 $p,q$ 为常数，称为二阶常系数齐次线性微分方程。
- 通用解法：将 $y=e^{rx}$ 求导，有 $y'=re^{rx},r''=r^2e^{rx}$ ，代入方程得 $r^2e^{rx}+pre^{rx}+qe^{rx}=0$ ，即 $(r^2+pr+q)e^{rx}=0$ 。由于 $e^{rx}\ne 0$ ，有 $r^2+pr+q=0$ ，称其为微分方程的特征方程。
  - 若特征方程有两个不相等的实根 $r_1,r_2$ ，则通解为 $y=C_1e^{r_1x}+C_2e^{r_2x}$ 。
  - 若特征方程有两个相等的实根 $r_1$ ，有一个解 $y=e^{r_1x}$ ，取另一个解为 $y=u(x)e^{r_1x}$ ，有 $y'=(u'+ur_1)e^{r_1x}$ ，$y''=(u''+2r_1u'+ur_1^2)e^{r_1x}$ ，代入得 $(u''+2r_1u'+ur_1^2+pu'+pur_1+qu)e^{r_1x}=0$ ，即 $u''+(2r_1+p)u'+(r_1^2+pr_1+q)u=0$ ，考虑 $r_1$ 为特征方程得解，即有 $u''=0$ ，取一个不为常数得解 $u=x$ ，即第二个解为 $y=xe^{r_1}x$ 。通解为 $y=(C_1+C_2x)e^{r_1x}$ 。
  - 若特征方程有一对共轭复根：$r_1=\alpha+\beta i,r_2=\alpha-\beta i$ 。利用欧拉公式 $e^{i\theta}=\cos \theta+i\sin \theta$ ，有 $y_1=e^{(\alpha+\beta i)x}=e^{\alpha x}(\cos \beta x+i\sin \beta x)$ ，$y_2=e^{(\alpha-\beta i)x}=e^{\alpha x}(\cos \beta x-i\sin \beta x)$ 。考虑到两个解得共轭关系，对两个解进行线性运算以得到实部和虚部，$\frac{y_1+y_2}{2}=e^{\alpha x}\cos \beta x$ ，$\frac{y_1-y_2}{2i}=e^{\alpha x}\sin \beta x$ ，同样是方程得解，因此微分方程得通解为 $y=e^{\alpha x}(C_1 \cos \beta x + C_2 \sin \beta x)$ 。

## 10 常系数非齐次线性微分方程

- 略。

## 例子

- 参见数学题集：微分方程。
